% !TEX root = 7370.tex





\section{Main stuff}

Let $k$ be a number field, $C_{/k}$ a smooth proper curve. Let $g$ be the 
genus of $C$. If $g=0$, either $C(k)=\varnothing$, or $C\simeq \dP^1_{/k}$. 
If $g>1$, then Faltings gave an ineffective proof that $\# C(k)<\infty$. 
If $g=1$, then either $C(k)=\varnothing$, or, if $C(k)\ne\varnothing$, then 
$C(k)$ is a finitely generated abelian group. Recall that the Birch and 
Swinnerton-Dyer conjecture is that $\rank(E(k))=\order_{s=1} L(E,s)$. The 
function $L(E,s)$ satisfies a functional equation $L(E,s) \sim \pm L(E,2-s)$. 
We expect $(-1)^{\rank(E)}=\pm$ accordingly. This is the ``sign conjecture.'' 
Kolyvagin and others have proved that if $L(E,s)$ has a pole of order at most 
$1$ at $1$, then BSD holds for $E$. A folklore question is: is 
$\sup_{E/\dQ} \rank(E)<\infty$?

Any $E_{/\dQ}$ can be written as $y^2=x^3+A x+B$ where $A,B\in \dZ$, and 
$p^6\mid B\Rightarrow p^4\nmid A$. The \emph{height} of $E$ is 
$H(E)=\max(4|A|^3,27 B^2)$. This is asymptotically degree-six in the roots 
of $x^3+A x+B$. We could have ordered $E$ by (Galois-theoretic) conductor. The 
reason we use height is that the number of elliptic curves with height 
$\leqslant X$ is $C X^{5/6}+(\text{error term})$ for some constant $C$. On the 
other hand, we have no idea how many elliptic curves there are with bounded 
conductor. So even though height isn't as conceptually elegant, we'll order 
elliptic curves by it. 

Given $E_{/\dQ}$ with algebraic rank $3$, we could numerically show that the 
analytic rank is $\leqslant 3$, then use sign considerations to get t
$r_\mathrm{an}\in \{1,3\}$. If $r_\mathrm{an}=1$, we know that 
$r_\mathrm{alg}=1$, a contradiction, hence $r_\mathrm{an}=3$. Thus, for 
(specific) elliptic curves with algebraic rank $3$, it is possible to prove 
BSD. At the present, no one knows how to do this for a family of elliptic 
curves. From the Kummer exact sequence $0\to E[p] \to E\xrightarrow p E \to 0$, 
one gets a short exact sequence
\[\begin{tikzcd}
  0 \ar[r] 
    & E(\dQ)/p \ar[r] 
    & \h^1(\dQ,E[p]) \ar[r] 
    & \h^1(\dQ,E)[p] 
    & 0 .
\end{tikzcd}\]
One has a similar short exact sequence for each place $v$. This yields a 
(now-familiar) commutative diagram:
\[\begin{tikzcd}
  0 \ar[r] 
    & E(\dQ)/p \ar[r] \ar[d] 
    & \h^1(\dQ,E[p]) \ar[r] \ar[d] 
    & \h^1(\dQ,E)[p] \ar[d] \ar[r] 
    & 0 \\
  0 \ar[r] 
    & \prod E(\dQ_v)/p \ar[r] 
    & \prod \h^1(\dQ_v,E[p]) \ar[r] 
    & \prod \h^1(\dQ_v,E)[p] \ar[r] 
    & 0.
\end{tikzcd}\]
Even better, we can write 
\[
  \selmer_p(E)  \ker\left(\h^1(\dQ,E[p])\to \h^1(\dA,E)[p]\right) ,
\]
where $\dA$ is the ring of adeles over $\dQ$ and ``$\h^1$'' denotes \'etale 
cohomology. 

We'd like to give a geometric interpretation of $\h^1(\dQ,E)$ and 
$\h^1(\dQ,E[p])$. First, note that 
$\dim (E(\dQ)/p)=\rank(E)+\delta$, where $\delta=\dim E[p](\dQ)\leqslant 2$. 
With respect to height, $\delta>0$ on a density zero set, so we may as well 
assume $\delta=0$. Recall there is a short exact sequence 
\[\begin{tikzcd}
  0 \ar[r] 
    & E(\dQ)/p \ar[r] 
    & \selmer_p(E) \ar[r] 
    & \sha[p] \ar[r] 
    & 0 .
\end{tikzcd}\]
Separating $\selmer_p(E)$ into its contributions from $E(\dQ)/p$ and 
$\sha[p]$ is very difficult. One conjectures that 
$\sha=\ker(\h^1(\dQ,E) \to \h^1(\dA,E))$ is finite for all $E$. This conjecture 
implies that $\sha[p]=0$ for almost all $p$. Cassels has constructed a perfect 
pairing $\sha\times \sha\to \dQ/\dZ$. So if $\#\sha<\infty$, then $\#\sha$ 
should be a perfect square. The ``$\sha$-part'' of BSD can be computed in 
some examples, and it always turns out to be a perfect square. 

[\ldots recap of strategy for Bhargava's proof\ldots]
\[
  \rho:\Gamma_\dQ\to \operatorname{GL}_2(\mathbf T_\mathfrak m) .
\]





\subsection{Group cohomology}

For the moment, let $G$ be a profinite group. By a $G$-module, we mean 
an abelian group $M$ with $G$-action, such that for all $m\in M$, the 
stabilizer $\stabilizer_G(m)$ is an open subgroup of $G$. The category of 
$G$-modules is an abelian category with enough injectives. Indeed, let 
$\cC$ be the category of finite sets with continuous $G$-action. Then the 
category of $G$-modules is equivalent to the category of sheaves of abelian 
groups on $\cC$. It is known in general that the category of abelian group 
objects in a Grothendieck topos has enough injectives. 

\begin{definition}
Let $M$ be a $G$-module. We define $\h^i(G,M)=\mathsf R^i (-)^G(M)$. 
\end{definition}

That is, $\h^i(G,-)$ is the $i$-th derived functor of $(-)^G$. The group 
$\h^2(G,M)$ classifies central extensions $0\to M\to X\to G\to 1$, up to 
isomorphism making the following diagram commute:
\[\begin{tikzcd}
  1 \ar[r] 
    & M \ar[r] \ar[d, equal] 
    & X \ar[r] \ar[d, "\wr"] 
    & G \ar[r] \ar[d, equal] 
    & 1 \\
  1 \ar[r] 
    & M \ar[r] 
    & Y \ar[r] 
    & G \ar[r] 
    & 1 .
\end{tikzcd}\]
For $i\leqslant 2$, $\h^i(G,M)$ can be more readily computed directly. Let 
\begin{align*}
  Z^1(G,M) &= \{f:G\to M\text{ continuous, such that }f(\sigma\tau)=f(\sigma)+\sigma(f(\tau))\} \\
  B^1(G,M) &= \{f:G\to M\text{ of the form }\sigma\mapsto \sigma(m)-m\text{ for some }m\in M\} .
\end{align*}
Then $\h^1(G,M)\simeq Z^1(G,M)/B^1(G,M)$. 

If $H\subset G$, the restriction functor $\res_H^G(-)$ from $G$-modules to 
$H$-modules is exact, so the natural inclusion 
$\h^0(H,\res_H^G M)\monic \h^0(G,M)$ extends canonically to a natural 
transformation $\h^\bullet(H,\res_H^G(-))\to \h^\bullet(G,-)$. 

\begin{theorem}
If $G$ acts trivially on $M$, then $\h^1(G,M)=\hom(G,M)$. 
\end{theorem}
\begin{proof}
If $G$ acts trivially, then $B^1(G,M)=0$. Also, $Z^1(G,M)$ consists of those 
$f:G\to M$ such that $f(\sigma\tau)=f(\sigma)+f(\tau)$. 
\end{proof}

Let $k$ be a number field. If $v$ is a place of $k$, write $G_v\subset G_k$ 
for the Galois group $\galois(\overline{k_v}/k_v)$. If $M$ is a $G_k$-module 
$v$ is a place of $k$, one puts 
\[
  \sha(M) = \ker\left(\h^1(k,M) \to \prod_v \h^1(k_v,M)\right) .
\]

\begin{theorem}
Let $k$ be a number field, $M$ a finite $G_k$-module. Then 
$\sha(M)$ is finite. 
\end{theorem}
\begin{proof}
Let $K=k(M)$; then $G_K$ acts trivially on $M$. If $f\in \sha(M)$, then 
$f|_{G_K}$ is a homomorphism cutting out an extension $L/K$. Since 
$f|_{G_v}=0$ for all places $v$ of $K$, we know that all primes in $L$ split 
completely (hence are unramified) over $K$. By the Hermite-Minkowski thorem, 
there are only finitely many possibilities for $f$. 
\end{proof}

Via the above proof, we see that cohomology relates to class groups (via 
Hermite-Minkowski). Let $M$ be a finite $\dF_p[G_{\dQ_l}]$-module. Put 
$M^\ast=\hom(M,\dmu_p)$. Then there is a 
perfect pairing 
$\h^\bullet(\dQ_l,M)\times \h^{2-\bullet}(\dQ_l,M^\ast)\to \h^2(\dQ_l,\dmu_p)$, 
and 
\[
  \sum_{i=0}^2 (-1)^i\dim_{\dF_p} \h^i(\dQ_l,M) = \begin{cases} 0 & l\ne p \\ -\dim(M) & l = p \end{cases}
\]
This is \emph{Local Tate Duality}. It should be thought of as analogous 
to algebraic topology. In fact, \'etale cohomology is the ``right'' cohomology 
theory for varieties, and satisfies a good duality theory that resembles 
Poincar\'e duality. There is a duality theory for modules over $G_k$ when $k$ 
is a global field. You can compute 
$\dim \h^1(\dQ,M)-\dim \h^2(\dQ,M)$ when $M$ is a $\dF_p[G_\dQ]$-module. 
Getting either one of $\h^1$ or $\h^2$ involves computing the class group of 
$\dQ(M)$. 





\subsection{Geometric interpretation of cohomology}

The elliptic curves 
\begin{align*}
  E_1 &: y^2=x^3+x+1 \\
  E_2 &: 3 y^2=x^3+x+1 ,
\end{align*}
are isomorphic over $\dQ(\sqrt 3)$ but not over $\dQ$. Considering such pairs 
is a standard approach to the $r_\mathrm{an}\leqslant 1$ cases of BSD. 

In general, if $L/K$ is a field extension and $X_{/L}$ is some ``arithmetic 
object'' the set of $Y_{/K}$ giving rise to $X$ via base-change is classified 
by $\h^1(\galois(L/K),\automorphisms X)$. Since $\automorphisms(X)$ might be 
nonabelian, this $\h^1(L/K,\automorphisms X)$ may only be a pointed set. 

Let $E_{/\dQ}$ be an elliptic curve. We'll realise $E[p]$ and 
$E(\overline\dQ)$ as automorphisms of pairs of objects, one entry of which is 
$E$. So $\h^1(\dQ,E[p])$ and $\h^1(\dQ,E)$ will classify descents of some type 
of object to $\dQ$. 

\begin{definition}
Let $G$ be a profinite group, $N$ a (possibly nonabelian) group with 
continuous $G$-action. Then $Z^1(G,N)$ is the set of continuous 
$f:G\to N$ such that $f(\sigma\tau)=f(\sigma)\sigma(f(\tau))$ for all 
$\sigma,\tau\in G$. If $f,g\in Z^1(G,N)$, we say they are 
\emph{cohomologous} if there exists $n\in N$ such that 
$f(\sigma)=n^{-1} g(\sigma) \sigma(n)$ for all $\sigma\in G$. Let 
$\h^1(G,N)=Z^1(G,N)/\sim$, where $f\sim g$ if $f$ is cohomologous to $g$. 
\end{definition}

We'll find elements of $\h^1(\dQ,E[p])$ that correspond bijectively to 
pairs $(C,D)$ where $C$ is a curve of genus $1$ over $\dQ$ and $D$ is a 
divisor of degree $p$ over $\dQ$. These correspond to maps 
$C\to S\simeq_{\overline\dQ} \dP^{p-1}$, where $C\simeq_{\overline\dQ} E$. 

\begin{example}
Let $C_{/\dQ}$ be the projective curve $3 x^3+4 y^3+5 z^3=0$. Then 
$C(\dQ)=\varnothing$. However, if we take some 
$x\in C(\overline\dQ)$ and let $D=\sum_{\sigma\in G_\dQ} (\sigma(x))$, then 
$D$ is a divisor on $C$ defined over $\dQ$. Essentially, the point is that 
even if $C(\dQ)=\varnothing$, we will have 
$\picard^\circ(C)(\dQ)\ne\varnothing$. 
\end{example}

\begin{theorem}
Let $E_{/\dQ}$ be an elliptic curve. Then $\selmer_p(E)$ is finite. 
\end{theorem}
\begin{proof}
We essentially reprove weak Mordell-Weil. Recall that if $l\ne p$ is a prime of 
good reduction, then $E[p]\monic E_{\dF_l}(\overline{\dF_l})$. Alternatively, 
the inertia group $I_l$ acts trivially on $E[p]$. So we'll prove that any 
$f\in \selmer_p E$ is unramified outside a (fixed) finite set, namely $p$ 
together with the set of bad primes for $E$. Let $S$ be that set. For 
$l\notin S$, the restriction $f|_{G_{\dQ_l}}$ is a coboundary in 
$\h^1(\dQ_l,E)$. So there exists $P\in E(\overline{\dQ_l})$ such that 
$f(\sigma)=\sigma(P)-P$ for all $\sigma\in G_{\dQ_l}$. But 
$\sigma(P)-P\in E[p]$. For $\sigma\in I_l$, $\sigma(P)-P=0$ in 
$E(\overline{\dF_l})$. Since $E[p]\monic E_{\dF_l}[p]$, we have 
$\sigma(P)=P$, i.e.~$f(I_l)=0$. We have shown that all classes 
$f\in \selmer_p(E)$ are unramified outside of $S$, which yields the result. 
\end{proof}

This proof depends on the finiteness of the class group. 

\begin{lemma}
Let $E_{/\dQ}$ be an elliptic curve, $\phi:E\to E$ a nonconstant map such 
that $\phi(0)=0$. Then $\phi$ is an isogeny. Moreover, if $\phi$ is an 
isomorphism ad commutes with all translations, then $\phi=1$. 
\end{lemma}
\begin{proof}
We sketch a proof of the latter claim. If $E$ is non-CM, then 
$\phi=\pm 1$. Clearly $-1$ does not commute with translations, so $\phi=1$. If 
$E$ has CM, think about $E_{/\dC}\simeq \dZ/\Lambda$ for $\Lambda$ an order 
in a quadratic imaginary field. Say $\Lambda=\langle 1,\tau\rangle$ for 
$\tau\in \dQ(\sqrt{-d})$ where $d\in \{1,3\}$. The only automorphisms are 
$\{\pm 1,\pm i\}$ or $\{\pm 1,\pm \omega,\pm\omega^2\}$. You can check 
directly that none of these commute with translations, except for $1$. 

Alternatively, just plug $x=0$ into $\phi(x+y)=\phi(x)+y$. 
\end{proof}

\begin{definition}
Let $k$ be a field of characteristic zero, $C_{/k}$ a curve. A \emph{twist} of 
$C$ is a curve $D_{/k}$ together with an isomorphism 
$\phi:C_{\overline k}\iso D_{\overline k}$. 
\end{definition}

The philosophy is that $\h^1(G_\dQ,\automorphisms(E_{\overline\dQ}))$ 
classifies twists of $E$ over $\dQ$. More generally, if ``$X_{/\dQ}$ is an 
object,'' then $\h^1(G_\dQ,\automorphisms(X_{\overline\dQ}))$ classifies 
twists of $X$.''

\begin{theorem}
Let $X_{/\dQ}$ be a twist of $\dP_{/\dQ}^n$. Then $X\simeq \dP^n$ if and only 
if $X(\dQ)\ne\varnothing$. Moreover, if $X(\dA)\ne\varnothing$, then 
$X(\dQ)\ne\varnothing$. 
\end{theorem}

We will use this theorem because $\alpha\in \selmer_p E$ gives rise to a map 
$C\to S$, where $C$ is a twist of $E$ and $S$ is a twist of 
$\dP^{p-1}_{/\dQ}$. But elements of $\selmer_p(E)$ are locally trivial. This 
will imply $C(\dA)\ne\varnothing$. Thus $S(\dA)\ne\varnothing$, so 
$S\simeq \dP^{p-1}$. We end up with a curve $C\subset \dP^{p-1}$. We hope to 
write such curves as the zero-locus of a single function, or a small 
managable set of functions. For $p\in \{2,3,5\}$, this can be done. 

Suppose we are given a twist $C'$ of $C_{/\dQ}$ with 
$\phi:C'_{\overline\dQ}\iso C_{\overline\dQ}$. Define 
$f:G_\dQ\to \automorphisms(C_{\overline\dQ})$ by 
$f(\sigma)=\phi^\sigma\circ\phi^{-1}$. Here, $\phi^\sigma(x)=\sigma(\phi(x))$. 

\begin{proposition}
As constructed above, $f$ is a $1$-cocycle. Moreover, adjusting $f$ by a 
$1$-coboundary preserves the isomorphism class of $C'$. So $C\mapsto f$ induces 
a bijection between the set of isomorphism classes of twists of $C$ and 
$\h^1(G_\dQ,\automorphisms(C_{\overline\dQ}))$. 
\end{proposition}
\begin{proof}
We begin with a computation: 
\begin{align*}
  f(\sigma\tau) &= \phi^{\sigma\tau}\phi^{-1} \\ 
    &= \phi^{\sigma\tau}(\phi^\tau)^{-1}\phi^\tau\phi^{-1} \\
    &= (\phi^\sigma\phi^{-1})^\tau \phi^\tau \phi^{-1} \\
    &= \prescript{\tau}{}{f(\sigma)} f(\tau) .
\end{align*}
The rest is relatively trivial. Showing surjectivity is a bit tricky -- this 
ends up being a special case of descent (\'etale descent, to be precise). 
\end{proof}

We'll begin with the easier case of a discrete $G_\dQ$-module. Let 
$f\in \h^1(G_\dQ,\automorphisms(M))$; we need to build a twist of $M$. 
Put $\sigma\cdot_f m = f(\sigma)(\sigma(m))$. Check that $\cdot_f$ gives 
a well-defined action of $G_\dQ$ on $M$. Write $f^\ast M$ for the twist of $M$ 
that we have defined. Check that if $f$ is a coboundary, then 
$M\simeq f^\ast M$. 

\begin{theorem}[Bhargava-Shankar]
Set $E:y^2=x^3-\frac{I}{3} x-\frac{J}{27}$ for $I,J\in k$. Then 
$E(k)/2$ is naturally in bijection with $\PGL_2$-orbits of $k$-soluble 
binary quartic forms having invariants $I$ and $J$, via 
\[
  (\varepsilon,\eta)\mapsto \frac{x^4}{4}-\frac 3 2 \varepsilon x^2 y^2 + 2\eta x y^3 + \left(\frac I 3-\frac 3 4 \varepsilon^2\right) y^4 .
\]
\end{theorem}





\subsection{Torsors}

\begin{definition}
Let $E_{/\dQ}$ be an elliiptic curve. A \emph{torsor} under $E$ is a curve 
$C_{/\dQ}$ with $E$-action such that $C_{\overline\dQ}\simeq E_{\overline\dQ}$ 
as $E$-varieties. 
\end{definition}

That is, we are given a map $\mu:E\times C\to C$ defined over $\dQ$ satisfying 
the appropriate associativity conditions. Given any $x\in C(\overline\dQ)$, the 
map $\mu(-,x):E_{\overline\dQ}\to C_{\overline\dQ}$ will be an isomorphism of 
varieties over $\overline\dQ$. 

\begin{definition}
Two $E$-torsors $C_1,C_2$ are isomorphic if there exists an $E$-equivariant 
isomorphism $\phi:C_1\iso C_2$ defined over $\dQ$. 
\end{definition}

So we need the following diagram to commute:
\[\begin{tikzcd}
  E\times C_1 \ar[r, "\mu_1"] \ar[d, "1\times \phi"] 
    & C_1 \ar[d, "\phi"] \\
  E\times C_2 \ar[r, "\mu_2"] 
    & C_2 .
\end{tikzcd}\]

The \emph{trivial torsor} is $E\times E\xrightarrow+ E$. 
Note that by definition, every torsor is a twist of the trivial torsor. Recall 
that $\automorphisms_E(E)$, the group of $E$-equivariant automorphisms of $E$, 
is $E$. Thus $\h^1(\dQ,E)$ classifies $E$-torsors up to isomorphism. 
In general, let $G_{/k}$ be a group scheme. Then $\h^1(\dQ,G)$ classifies 
$G$-torsors up to isomorphism. 

The papers \cite{cfnss-2008,cfnss-2009,cfnss-2014} give many different 
descriptions of elements of $\h^1(\dQ,E[p])$ for $p$ not necessarily prime. 

\begin{definition}
A torsor divisor class pair (of degree $p$) is an $E$-torsor with a divisor 
$D$ of degree $p$, defined over $\dQ$. 
\end{definition}

Two torsor divisor class pairs $(C_1,D_1)$, $(C_2,D_2)$ are isomorphic if there 
is an isomorphism $\phi:C_1\to C_2$ of $E$-torsors such that 
$\phi^\ast D_2\sim D_1$ in $\picard(C_1)$. The trivial torsor divisor class 
pair is $(E,p\cdot 0)$. 

\begin{lemma}
Every torsor divisor class pair is a twist of $(E,p\cdot 0)$. 
\end{lemma}
\begin{proof}
Let $\phi:C_{\overline\dQ}\iso E_{\overline\dQ}$. We need 
$\phi^\ast(p\cdot 0)\sim 0$. Equivilantly, we need 
$p\cdot 0-(\phi^{-1})^\ast D\sim 0$. It is sufficient to show that the sum of 
points (with multiplicities) in $\phi^{-1\ast} D$ equal to $0$ on $E$? Say 
the sum is $x\in E(\overline\dQ)$. Let $p y=x$ and compose $\phi$ with 
``translate by $-y$.'' This gives the result. 
\end{proof}

\begin{lemma}
$\automorphisms_{E_{\overline\dQ}}(E,p\cdot 0) = E[p]$. 
\end{lemma}
\begin{proof}
Any automorphism of a torsor divisr class pair must be translation by some 
element, and the condition $\phi\ast D_2\sim D_1$ forces that point to be 
$p$-torsion. 
\end{proof}

It follows that $\h^1(\dQ,E[p])$ is in bijection with the set of isomorphism 
classes of torsor divisor class pairs. Note that 
$\h^1(\dQ,E[p])\supset \selmer_p E\supset E(\dQ)/p$. The latter set corresponds 
to those $(C,D)$ for which $C(\dQ)\ne\varnothing$, while $\selmer_p E$ 
corresponds to the set of $(C,D)$ for which $C(\dA)\ne\varnothing$. 

\begin{definition}
A \emph{Brauer-Severi diagram} $C\to S$ is a morphism from $C$, an $E$-torsor, 
to $S$, a twist of $\dP^{p-1}$. 
\end{definition}

Twoo Brauer-Severi diagrams $C_1\to S_1$ and $C_2\to S_2$ are isomorphic if 
there isomorphisms $\phi:C_1\iso C_2$ and $\psi:S_1\to S_2$ making the 
following diagram commute:
\[\begin{tikzcd}
  C_1 \ar[r] \ar[d, "\phi"] 
    & S_1 \ar[d, "\psi"] \\
  C_2 \ar[r] 
    & S_2 .
\end{tikzcd}\]
The trivial Brauer-Severi diagram is the map $E\to \dP^{p-1}$ coming from 
the divisor $p\cdot 0$. 

\begin{lemma}
The trivial Brauer-Severi diagram $E\to \dP^{p-1}$ satisfies 
$\automorphisms(E\to \dP^{p-1})=E[p]$. 
\end{lemma}
\begin{proof}
Let $\phi:E_{\overline\dQ}\iso E_{\overline\dQ}$. We need 
$\phi^\ast(p\cdot 0)=(p\cdot 0)$. We know $\phi=(-)+x$ for some $x$, and 
$\phi^\ast(p\cdot 0)\sim (p\cdot 0)$ implies $x\in E[p]$. We need an 
automorphism of projective space making the following diagram commute:
\[\begin{tikzcd}
  E \ar[r, "p\cdot 0"] \ar[d, "+x"] 
    & \dP^{p-1} \ar[d, dashrightarrow] \\
  E \ar[r, "\phi^\ast(p\cdot 0)"] 
    & \dP^{p-1} .
\end{tikzcd}\]
Such an automorphism exists because $\automorphisms(\dP^{p-1})=\GL(p)$ acts 
transitively on $\dP^{p-1}$. 
\end{proof}

\begin{definition}
An \emph{$n$-covering} of $E$ is a curve $C_{/\dQ}$ together with 
$\pi:C\to E$, such that there is an isomorphism 
$\phi:C_{\overline\dQ}\iso E_{\overline\dQ}$ making the following diagram 
commute: 
\[\begin{tikzcd}
  C \ar[d, "\phi"] \ar[dr, "\pi"] \\
  E \ar[r, "n"] 
    & E .
\end{tikzcd}\]
\end{definition}

The trivial $n$-covering is $\cdot n:E\to E$. 

\begin{lemma}
All $n$-coverings are twists of the trivial $n$-covering. Moreover, 
the trivial $n$-covering has automorphism group $E[n]$. 
\end{lemma}

Thus isomorphism classes of $n$-coverings of $E$ are in bijection with 
$\h^1(\dQ,E[n])$. 

\begin{definition}
Let $\pi:C\epic E$ be an $n$-covering. Then $(C,\pi)$ is \emph{solvable} 
if $C(\dQ)\ne\varnothing$, and \emph{locally soluble} if 
$C(\dA)\ne\varnothing$. 
\end{definition}

Let $x_0\in E(\dQ)/p\subset \selmer_p E\subset \h^1(\dQ,E[p])$. Consider 
$\pi(x)=p\cdot x+x_0$. Then $\phi(x)=x+(\text{some }\frac 1 p x_0)$. So 
$\pi$ is trivial if and only if $x_0=0$ in $E(\dQ)/p$. 

Let $\alpha\in \selmer_p(E)$. We know that $\alpha=0$ in 
$\h^1(\dA,E)$. Thus, if $C$ is the corresponding $p$-covering, we have 
$C(\dA)\ne\varnothing$. Finally, $\alpha$ will correspond to a Brauer-Severi 
embedding which is locally soluble. Since projective spaces satisfy the 
Hasse principle, locally soluble Brauer-Severi embeddings look like 
$C\to \dP^{p-1}$. 





\subsection{Review and plan of attack}

Let $E_{/\dQ}$ be an elliptic curve. So far, we've (mostly) proved that 
$E(\dQ)$ is finitely generated. The one thing we skipped was the fact that 
$E[n]\monic \cE_{\dF_l}(\overline{\dF_l})$ so long as $l\nmid n$ and 
$l$ is a prime of good reduction. We can write $E(\dQ)\simeq\dZ^r\oplus T$, 
where $T$ is a finite group. Due to Mazur's work in \cite{mazur-1977}, 
we completely understand $T$. Mazur's proof requires some extremely delicate 
algebraic geometry. The rank $r=\rank(E)$ is still poorly understood. 

One way to bound $r$ is to look at the canonical short exact sequence 
\[\begin{tikzcd}
  0 \ar[r] 
    & E(\dQ)/p \ar[r] 
    & \selmer_p(E) \ar[r] 
    & \sha(E)[p] \ar[r] 
    & 0 .
\end{tikzcd}\]
It gives us the bound $p^r\leqslant \# \selmer_p(E)$, or equivalently 
$r\leqslant \dim \selmer_p(E)$. We interpreted elements of $\selmer_p(E)$ as 
locally soluble $p$-coverings of $E$, and elements of 
$E(\dQ)/p\subset \selmer_p(E)$ as those coverings which are actually 
globally soluble. Both these groups live inside $\h^1(\dQ,E[p])$, which 
classifies \emph{all} $p$-coverings of $E$. Recall that a $p$-covering is 
a map $\psi:C\epic E$ defined over $\dQ$, for which there exists an isomorphism 
$\phi:C_{\overline\dQ}\to E_{\overline\dQ}$ making the following diagram 
commute:
\[\begin{tikzcd}
  C_{\overline\dQ} \ar[dr, "\psi"] \ar[d, "\phi"] \\
  E_{\overline\dQ} \ar[r, "p"] 
    & E .
\end{tikzcd}\]
For such a covering to be locally soluble, one needs $C(\dA)\ne\varnothing$, 
and to be globally soluble, one needs $C(\dQ)\ne\varnothing$. 
The group $\h^1(\dQ,E[p])$ classifies diagrams $C\to S$, where $S$ is a twist 
of $\dP^{p-1}_{/\dQ}$. The group $\selmer_p(E)$ classifies diagrams 
$C\to S$, where $S\simeq \dP^{p-1}$. 

Note that everything we have done with $\selmer_p(E)$ and $\h^1(\dQ,E[p])$ 
works for $p=n$ a composite number. Bhargava and Shankar find 
$\average(\#\selmer_n)$ for $n\in \{2,3,4,5\}$. It's 
\[
  \sigma(n) = \sum_{d\mid n} d .
\]
These sorts of sums show up in Eisensterin series, which are used extensively 
in Mazur's classification of the possible torsion in $E(\dQ)$. 

Let $p=2$. Then $\selmer_2 E$ classifies degree-two maps $C\to \dP^1$. 
From Riemann-Hurwitz, we get 
\[
  \chi(C) = 2\chi(\dP^1) - \sum (e_x -1) ,
\]
which shows that there must be four branch points. So $C$ comes from a 
binary quartic $a x^4+b x^3 y+c x^2 y^2+d x y^3+e y^4$. 

If we set $p=3$, we are looking at maps $C\monic \dP^2$ whose image is the 
zero locus of a ternary cubic. Such cubics live in a $10$-dimensional space. 

For $n=4$, we classify maps $C\monic \dP^3$. The image is no longer the zero 
locus of one function, but rather a complete intersection of two quadrics. 

When $p=5$, we have maps $C\monic \dP^4$. The image is not a complete 
intersection. It will be defined by five quadrics coming from 
$4\times 4$ submatrices of a skew-symmetric $5\times 5$ matrix (all thought of 
as quadratic forms). The moral of the story is that the geometry is getting a 
\emph{lot} harder. 

\begin{theorem}
If, for all $p$, $\average(\#\selmer_p)=p+1$, then BSD holds $100\%$ of the 
time. 
\end{theorem}

The curves in the above theorem will all have 
$r_\mathrm{an},r_\mathrm{alg}\leqslant 1$. 

The group $E(\dQ)/2$ corresponds to globally soluble diagrams $C\to \dP^1$, 
which in turn correspond to binary quartics. The point $(\varepsilon,\eta)$ on 
the elliptic curve $E:y^2=x^3-\frac I 3 x - \frac{J}{27}$ corresponds to the 
quartic 
\[
  \frac{x^4}{4}-\frac 3 2 \eta^2 x^2 y^2 + 2\eta x y^3 + \left(\frac I 3-\frac 3 4\varepsilon^2\right) y^4 .
\]
The point $0\in E(\dQ)/2$ corresponds to a quartic having a linear factor. 

\begin{example}
Let $(I,J)=(3,-27)$. Then our curve is $E:y^2=x^3-x+1$. The point 
$(1,1)\in E(\dQ)$ has $(1,1)+(1,1)=(-1,1)=(\varepsilon,\eta)$. So the 
corresponding quartic should have a linear factor. This quartic is 
\[
  \frac 1 4 x^4 + \frac 3 2 x^2 y^2 + 2 x y^3 + \frac 1 4 y^4 
    \sim \frac 1 4 (x^4 + 6 x^2 + 8 x+1) ,
\]
which has the integer $x=1$ is a root. The quartic corresponding to $(1,1)$ 
is 
\[
  \frac 1 4 x^4 - \frac 3 2 x^2 y^2 + 2 x y^3 + \frac 1 4 y^4 
    \sim \frac 1 4(x^4-6 x^2+8 x+1) ,
\]
which has no rational roots. 
\end{example}

\begin{theorem}
Let $E_{/\dQ}$ be the affine curve given by $y^2=x^3+A x+B$. Then 
$\# E(\dZ)<\infty$. 
\end{theorem}

Looking ahead: our job now is to count binary quartic forms. They live 
in the space $V_R=\{(a,b,c,d,e)\in R^5\}$ where $R$ is some commutative 
ring (probably just $\dZ$, $\dQ$, or some $\dQ_v$). Write an element of 
$V_R$ as $f=a x^4 + \cdots + e y^4$. The group 
$\GL_2(R)$ acts on $V_R$ by 
\[
  (\gamma\cdot f)(x,y) = f\left(\begin{pmatrix} x & y \end{pmatrix} \gamma\right) .
\]
Set 
\begin{align*}
  I &=12 a e-3 b d+c^2 \\
  J &= 72 a c e+9 b c d-27 c d^2 - 27 e b^2 - 2 c^3 .
\end{align*}
Then $\dQ[a,b,c,d,e]^{\SL_2^\pm(\dQ)} = \dQ[I,J]$ is a polynomial ring. 
We'll count binary quartics with given invariant $(I,J)$. That will correspond 
to elliptic curves $E_{/\dQ}$ of the form $y^2=x^3+\frac I ? + \frac J \ast$, 
where $?$ and $\ast$ are fixed constants only involving powers of $2$ and $3$. 
For given $(I,J)$, there are only finitely many equivalence classes of 
quartics. 

If we studied binary quadratics $a x^2+b x y+c y^2$, the ring of invariants 
is generated by the discriminant $b^2-4 a c$. The crucial property is: is 
$b^2-4 a c\equiv 0\pmod 4$ for $f\in V_\dZ$?

\begin{theorem}
A pair $(I,J)$ occurs as the invariant of a binary quartic form if and only if 
\begin{enumerate}
  \item $(I,J)\equiv (0,0)\mod{(3,27)}$, 
  \item $(I,J)\equiv (1,\pm 2)\mod{(9,27)}$,
  \item $(I,J)\equiv (4,\pm 16)\mod{(9,27)}$,
  \item $(I,J)\equiv (7,\pm 7)\mod{(9,27)}$,
\end{enumerate}
\end{theorem}

Modulo $(9,27)$, there are $9$ pairs. So $\frac{1}{27}$ of pairs occur. 

\begin{theorem}
Let $h^{(i)}(I,J)$ be the number of $\GL_2(\dZ)$-equivalence classes of 
irreducible binary quartic forms having invariants $(I,J)$, and having 
$4-2 i$ real roots. Then 
\begin{align*}
  \sum_{H(I,J)< X} h^{(0)}(I,J) &= \frac{4}{135} \zeta(2) X^{5/6} + O(X^{3/4+\epsilon}) \\
  \sum_{H(I,J)<X} h^{(1)}(I,J) &= \frac{32}{135} \zeta(2) X^{5/6}+O(X^{3/4+\epsilon}) \\
  \sum_{H(I,J)<X} h^{(2)}(I,J) &= \frac{8}{135} \zeta(2) X^{5/6} + O(X^{3/4+\epsilon}) ,
\end{align*}
where $H(I,J) = \max(|I|^3,J^2)$ [with some constants]. 
\end{theorem}

We have to omit the $(I,J)$ corresponding to singular curves, but that's a 
thin set with size $O(X^{1/3})$. 

We need to understand $\GL_2(\dZ)\backslash V_\dZ$. We'll also be 
interested in $\GL_2(\dR)\backslash V_\dR$ or $\GL_2(\dZ)\backslash V_\dR$. 
We'll find a fundamental domain for something like 
$\GL_2(\dZ)\backslash V_\dR$, and count lattice points inside the domain. 
The fundamental domain will have a cusp and a ``main body.'' You can estimate 
the volume of the main body; this gives (roughly) the number of integral 
points. To handle the cusp, we first thicken it slightly, then find that 
far out lattice points have linear factors, so they correspond to 
$0\in \selmer_2 E$. 





\subsection{The case \texorpdfstring{$p=2$}{p=2}}

For any ring $R$, let $V_R$ be the set of binary quartic forms over $R$. 
We're especially interested in $V_\dZ$, $V_\dR$, and $V_\dQ$. Recall that 
$\GL_2(R)$ acts on $V_R$. We'd like to count elements of 
$\GL_2(\dZ)\backslash V_\dZ$. 

In general, if a discrete group $G$ acts on a manifold $X$, it is useful to 
find a fundamental domain $\cF\subset X$ for the action of $G$ on $X$. The 
example we care about is $\GL_2(\dZ)$ acting on $V_\dR$. 

The group $\SL_2(\dR)$ acts on the upper half-plane $\fH=\{z\in \dC:\Im z>0\}$ 
in the standard way via fractional linear transformations:
\[
  \mat{a}{b}{c}{d}\cdot z = \frac{a z+b}{c z+d} .
\]
The action is transitive, because 
\[
  \mat{\sqrt x}{x/\sqrt y}{}{1/\sqrt y}\cdot i = x+i y .
\]
Let's compute the stabilizer. If $\mat{a}{b}{c}{d}\cdot i=i$, then 
$a=d,b=-c$. But the matrix lies in $\SL_2(\dR)$, so 
$\det=a^2+b^2=1$, whence $\mat{a}{b}{-b}{a}\in \SO_2(\dR)$. It easily follows 
that $\stabilizer_{\SL_2(\dR)}(i) = \SO_2(\dR)$. So we can think of 
$\SL_2(\dR)/\SO_2(\dR)\simeq \fH$. 

One conceptual picture here is: $\GL_2(\dR)$ acts on $\dC/\dR$, and elements 
with negative determinant swap $\fH$ with $\fH^-=\{z\in \dZ:\Im z<0\}$. 
Connected components, symmetric spaces, \ldots. 

[K.~Conrad notes, maybe NAK decomposition.

Serre's \emph{Arithmetic}

Bump

Gelbart: \emph{Automorphic forms an adele groups}]

A couple elements of $\SL_2(\dZ)$ act in easily computable ways:
\begin{align*}
  \mat{1}{1}{}{1}\cdot z &= z+1 \\
  \mat{}{-1}{1}{}\cdot z &= -\frac 1 z .
\end{align*}

\begin{theorem}
A fundamental domain for the action of $\SL_2(\dZ)$ on $\fH$ is 
\[
  \cF = \{z\in \fH:|z|\geqslant 1\text{ and }-1/2\leqslant \Im z\leqslant 1/2 \} [fudge on boundary].
\]
\end{theorem}
\begin{proof}
This proof is [p.~77 of Serre]. Let $\gamma\in \SL_2(\dZ)$, and write 
$\gamma=\mat{a}{b}{c}{d}$. Then 
\[
  \gamma\cdot z = \frac{a z+b}{c z+d} = \frac{(a z+b)(c\bar z+d)}{|c z+d|^2} ,
\]
which has imaginary part $|c z+d|^{-2} \Im(z)$. Fix $z_0\in \fH$. Note that 
$\Im(\gamma\cdot z_0)>\Im(z_0)$ if and only if $|c z_0+d|$. The set 
$\{c z_0+d:c,d\in \dZ\}\subset \dC$ is a lattice, so its intersection with 
$\{z\in \dC:|z|<1\}$. It follows that in $\SL_2(\dZ)\cdot z_0$, there is an 
element which attains the largest possible size for $\Im(\gamma\cdot z_0)$. 
As $\mat{1}{b}{}{1} z_0 = z_0+b$, we can choose a representative $z_1$ of 
$\SL_2(\dZ)\cdot z_0$ with maximal imaginary part, which also has real 
part in $[-1/2,1/2)$. Furthermore, $|z_1|\geqslant 1$. Indeed, otherwise 
$\mat{}{-1}{1}{}\cdot z_1=-z_1^{-1}$, which either has size $>1$ or bigger 
imaginary part. We've shown that every orbit $\SL_2(\dZ)\cdot z_0$ intersects 
$\cF$. All we need to do is show that if $z_1,z_2\in \cF$ are in the same 
$\SL_2(\dZ)$-orbit, then 
\begin{enumerate}
  \item $z_2=z_1+1$, or 
  \item $z_2=-1/z_1$ and $|z_1|=|z_2|=1$. 
\end{enumerate}
Without loss of generality, suppose $z$ and $\gamma z$ are both in 
$\overline\cF$ and have $\Im(\gamma z)\geqslant \Im(z)$. So for 
$\gamma=\mat{a}{b}{c}{d}$, we have $|c z+d|\leqslant 1$ and $|z|\geqslant 1$. 
If $|c|\geqslant 2$, then $|c z+d|\geqslant 1$. So $c\in \{0,-1,1\}$. 

If $c=0$, we need only consider the case 
$\gamma=\mat{1}{b}{}{1}$, which translates to the right by $b\in \dZ$. 

If $c=-1$, this is similar to $c=1$. 

If $c=1$, $|c z+d|=|z+d|\leqslant 1$. Then $d\in \{-1,0,1\}$. Suppose $d=0$; 
we look at $\mat{a}{-1}{1}{} z=a-z^{-1}$, which is not in 
$\overline\cF$ unless $|z|=1$. We get $z=e^{2\pi i/3}$ or $e^{\pi i/3}$. The 
other cases are similar. 
\end{proof}

For the moment, let's study binary quadratic forms $f=a x^2+b x y_c y^2$ 
over $\dZ$, up to $\GL_2(\dZ)$-equivalence. We'll assume the fact that 
$\mat{1}{1}{}{1}$ and $\mat{}{-1}{1}{}$ generate $\SL_2(\dZ)$. We compute: 
\begin{align*}
  \mat{1}{1}{}{1} f(x,y) &= f\left(\begin{pmatrix} x & y \end{pmatrix} \mat{1}{1}{}{1}\right) \\
    &= f(x,x+y) \\
    &= a x^2+b x(x+y)+c(x+y)^2 \\
    &= (a+b+c) x^2 +(b+2 c) x y + c y^2 .
\end{align*}
Similarly, if $z$ is a root of the dehomogenization 
$a x^2+b x+c$, then $z-1$ is a root of $\mat{1}{}{1}{1}\cdot f$, and 
$-1/z$ is a root of $\mat{}{-1}{1}{}\cdot f$. Thus the action of $\SL_2(\dZ)$ 
on binary quadratic forms over $\dZ$ induces the standard action on the roots. 
Let's work with positive definite forms (this is the easy case: on the same 
level as negative definite). So $a>0$ and $b^2-4 a c<0$. Thus roots 
$z,\bar z$ live in an imaginary quadratic field. Indefinite quadratic forms 
have real roots, so we're working with real quadratic fields, whose rings of 
integers have infinite unit groups. 

So we're trying to classify positive-definite binary quadratic forms over $\dZ$ 
with $a,c>0$, up to equivalence. They have roots $\bar z$, $z\in \fH$. 
Given a positive-definite binary quadratic form $f$, find 
$\gamma\in \SL_2(\dZ)$ such that the root of $\gamma\cdot f$ is in $\cF$. The 
new form equivalent to $f$ is $a x^2+b x y+c y^2$, where 
$\Delta=b^2-4 a c<0$. We care about the root 
$z=\frac{-b+i\sqrt{|\Delta|}}{2a}$. Since $z\in \cF$, we have 
$|b|\leqslant a$. Moreover, $|z|\geqslant 1$ implies 
$c\geqslant a$. Now 
$3 a^2+b^2\leqslant 4 a c$, so 
$a^2\leqslant \frac{|\Delta|}{3}$, whence $a\leqslant \sqrt{|\Delta|/3}$. 
How do we count inequivalent positive-definite binary quadratic forms over 
$\dZ$ with discriminant $\Delta$? We need $a,b,c$ with 
$0\leqslant |b|\leqslant a \leqslant \sqrt{|\Delta|/3}$. Given fixed 
$\Delta$, there are only finitely many such $a,b$, and $c$ is determined by 
$a,b$. We'll proceed to do this with indefinite quadratic forms. 





\subsection{Binary quartic forms}

Let $R\subset \dR$ be a ring. We want to understand the action of $\GL_2(R)$ on 
the space $V_\dR$ of real binary quartic forms. Write such a form as 
\[
  f = a x^4 + b x^3 y + c x^2 y^2 + d x y^3 + e y^4 .
\]
Given $f\in V_\dR$, define 
\begin{align*}
  I &= 12 a c-3 b d+c^2 \\
  J &= 72 a c e+ 9 b c d-27 a d^2-27b^2 e- 2c^3 .
\end{align*}
We can think of $I,J$ as functions on the scheme $V_{/\dZ}$. Any 
$\gamma\in \GL(2)$ acts on $V$ by 
\[
  \gamma\cdot f = f\left(\begin{pmatrix} x & y \end{pmatrix} \gamma \right) .
\]
We have, for $\gamma\in \GL(2)$, the identities:  
\begin{align*}
  I(\gamma\cdot f) &= (\det\gamma)^4 I(f) \\
  J(\gamma\cdot f) &= (\det\gamma)^6 J(f) .
\end{align*}
Thus $I$ and $J$ are $\SL^\pm(2)$-invariant functions on $V$. The \emph{height} 
of $f\in V_\dR$ is 
\[
  H(f) = \max\{|I|^3,J^2/4\} .
\]
Our goal is to count the number of $f\in \GL_2(\dZ)\backslash V_\dR$ with 
$H(f)\leqslant X$. As with binary quadratic forms, we'll have to treat the 
different possible signatures of $f$ separately. Put, for $R\subset \dR$:
\begin{align*}
  V_R^{(0)} &= \{f\in V_R:f\text{ has four real roots}\} \\
  V_R^{(1)} &= \{f\in V_R:f\text{ has two real roots}\} \\
  V_R^{(2-)} &= \{f\in V_R:f\text{ is negative definite}\} \\
  V_R^{(2+)} &= \{f\in V_R:f\text{ is positive definite}\} .
\end{align*}

\begin{proposition}
The fundamental domains for $V_\dR^{(\ast)}$ with $\GL_2(\dR)$-action are: 
\begin{align*}
  L_\dR^{(0)} &= \left\{x^3 y-\frac{x y^3}{3} - \frac{J y^4}{27}:-2<J<2\right\} \\
  L_\dR^{(1)} &= \ldots \\ 
  L_\dR^{(2\pm )} &= \ldots 
\end{align*}
\end{proposition}

The fundamental domains $L_\dR^{(1)}$ and $L_\dR^{(2\pm)}$ have similarly 
explicit fundamental domains. An all of the $L_\dR^{(\ast)}$, the coefficients 
are bounded. In other words, 
$V_\dR/\GL_2(\dR)$ has finite volume. It will be convenient to choose a compact 
subgroup $G_0\subset \GL_2(\dR)$, and consider, for $h\in G_0$, the coset 
$h L_\dR^{(\ast)}$. These cosets will be contained in some compact set which 
depends only on $G_0$. We care about $\GL_2(\dZ)\backslash V_\dZ$. This leads 
us to study $\GL_2(\dZ)\backslash \GL_2(\dR)$. In the previous subsection, we 
got a pretty good understanding of $\SL_2(\dZ)\backslash \SL_2(\dR)/\SO(2)$. 
We have 
\[
  \GL_2(\dZ)\backslash \GL_2(\dR) = \SL_2(\dZ)\backslash \GL_2^+(\dR)  = \SL_2(\dZ)\backslash N A K \Lambda ,
\]
in which 
\begin{align*}
  N &= \mat{1}{}{\ast}{1} \\
  A &= \left\{\mat{t^{-1}}{}{}{t}:t>0\right\} \\
  K &= \SO(2) \\
  \Lambda &= \left\{\mat{\lambda}{}{}{\lambda}:\lambda>0\right\} 
\end{align*}

\begin{proposition}
The multiplication map $N\times A\times K\times \Lambda\to \GL_2(\dR)^+$ is 
a homeomorphism. 
\end{proposition}
\begin{proof}
This is standard. 
\end{proof}

So $\GL_2(\dZ)\backslash \GL_2(\dR)$ has the same fundamental domain 
\[
  \cG = \left\{\mat{1}{}{u}{1} \mat{t^{-1}}{}{}{t}k \mat{\lambda}{}{}{\lambda}:u\in [-1/2,1/2],t\geqslant \sqrt{\frac{\sqrt 3}{2}}\right\} ,
\]
where we fudge the bounds for $u$ appropriately to be in one or two intervals, 
depending on $t$. Let $h\in G_0$, our compact subgroup of $\GL_2(\dR)$. Then 
$\cG h L_\dR^{(\ast)}$ is not compact (moreover, it is a multiset -- some 
elements of $V_\dR$ occur with multiplicities $>1$). 

If $x\in V_\dR^{(\ast)}$, how many times does the $\GL_2(\dZ)$-orbit of $x$ 
intersect $\cG h \cdot L_\dR^{(\ast)}$? There exists a unique 
$x_L\in h L_\dR^{(\ast)}$ that is $\GL_2(\dR)$-equivalent to $x$. If 
$g\cdot x_L=x$, then $g' x_L\sim_{\GL_2(\dZ)} x$ if and only if 
$g' = \gamma g \tilde g$ for some $\gamma\in \GL_2(\dZ)$ and 
$\tilde g\in \stabilizer(x_L)\GL_2(\dR)$. Thus $g$ and $g'$ represent the same 
double coset in 
\[
  \GL_2(\dZ)\backslash \GL_2(\dR)/\stabilizer_{\GL_2(\dR)}(x_L) .
\]
The number of such cosets is: 
\[
  \frac{\#(g \stabilizer_{\GL_2(\dR)}(x_L)g^{-1})}{\#(\SL_2(\dZ)\cap g\stabilizer_{\GL_2(\dR)}(x_L)g^{-1})} = \frac{\#\stabilizer_{\GL_2(\dR)}(x)}{\#\stabilizer_{\GL_2(\dZ)}(x)} .
\]
Both stabilizers contain $\dmu_2$. In fact, 
$\stabilizer_{\GL_2(\dZ)}(x)=\{\pm 1\}$ away from a set of measure zero. On the 
other hand, 
\[
  \#\stabilizer_{\GL_2(\dR)}(x) = \begin{cases} 8 & \ast \ne 1 \\ 4 & \ast = 1 \end{cases} ,
\]
again, away from a set of measure zero. 

\begin{definition}
$R_X(h\cdot L^{(\ast)})$ is the multiset of $w\in \cG h\cdot L^{(\ast)}$ such 
that $H(w)\leqslant X$. 
\end{definition}

Let $N(V_\dZ^{(\ast)},X)$ be the number of integral irreducible binary quartic 
forms with signature of type $\ast$ and height $\leqslant X$. Let 
$n_{(\ast)}=\frac 1 2\#\stabilizer_{\GL_2(\dR)}(\ast)$. Then 
\[
  n_{(\ast)} N(V_\dZ^{(\ast)},X) = \#\{\text{irred.~int.~points in }R_X(h\cdot L^{(\ast)})\text{ weighted by $1/r$}\},
\]
in which $2 r=\#\stabilizer(\ast)$. Let $h\in G_0$. Then the number of 
reducible integral binary quartic forms in $R_X(h\cdot L^{(\ast)}$ is 
$O(X^{2/3+\epsilon})$. There are roughly $O(X^{5/6})$ forms with height 
$\leqslant X$. 

For $n\in \dN$, let $d(n)$ be the number of divisors of $n$. So if 
$n=\prod p^{e_p}$, we have $d(n)=\prod (e_p+1)$. 

\begin{lemma}
$\limsup_{n\to \infty} \frac{\log d(n)}{\log n/\log\log n} = \log 2$. 
\end{lemma}

As a corollary, $d(n)=o(n^\epsilon)$ for all $\epsilon>0$. We'll count 
quartics that have a factor $p x+q y$. This will tell us $p\mid a$ and 
$q\mid e$. 




