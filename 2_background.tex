% !TEX root = 7370.tex

\section{Background}

We'll thread a very narrow path to the main theorems, assuming a bunch of 
facts along the way. A good source on the algebraic geometry we'll do is
\cite[ch.2,3]{silverman-2009}. 





\subsection{Riemann-Roch}

We'll spend the rest of this subsection explaining the terms in the following 
theorem. 

\begin{theorem}[Riemann-Roch]
Let $C_{/k}$ be a smooth projective curve. Let $K$ be the canonical divisor and 
$D$ a divisor. Then $l(D)-l(K-D)=\deg D-g+1$. 
\end{theorem}

For us, a curve $C_{/k}$ is the zero locus of a (non-constant) polynomial 
$f\in k[x,y]$. We stress the fact that $k$ is \emph{not} necessarily 
algebraically closed here. Pictorially, smoothness means that $C$ has no 
cusps or self-intersections. For example, $f$ can't be something like 
$x y$ or $x^2-y^3$. More formally, we want the tangent space to be 
$1$-dimensional at every point on $C$. For any $c\in C$, we have a 
matrix 
$\begin{pmatrix} \frac{\partial f}{\partial x}(c),\frac{\partial f}{\partial y}(c)\end{pmatrix}$
which needs to be nondegenerate, i.e.~the partials of $f$ never 
simultaneously vanish. Note that here, ``$c\in C$'' means $c\in C(\bar k)$, so 
we consider points not defined over $k$. We'll constantly move between the 
affine curve $V(f)\subset \dA^2$ and the projective curve in $\dP^2$ cut out by 
the projectivisation of $f$. 

A \emph{divisor} on a curve $C$ is a formal $\dZ$-linear combination of points 
(defined over $\bar k$). 

\begin{example}
Let $C:x^2+y^2=10$. Let $P=(4,i\sqrt 6)$ and $Q=(4,-i\sqrt 6)$. Then $P$ and 
$Q$ are not defined over $\dQ$, but $P+Q$ is a divisor on $C$ defined over 
$\dQ$. 
\end{example}

The absolute Galois group $G_k$ of $k$ acts on the space of divisors on $C$. We 
say a divisor $D$ is \emph{defined over $k$} if $D=D^\sigma$ for all 
$\sigma\in G_k$. 

We put an equivalence relation on divisors: $D_1\sim D_2$ if 
$D_1-D_2=\divisor(f)$ for some rational function $f$ on $C$. 
So we need to define $\divisor(f)$. Let $k[C]=k[x,y]/f$ be the ring of regular 
functions on $f$, and let $k(C)$ be the field of fractions of $k[C]$; we call 
$k(C)$ the field of \emph{rational functions} on $C$. Any rational function 
$f$ induces a morphism $f:C\to \dP^1$. Since $C$ is projective, this map is 
either constant or surjective. We can now put 
\[
  \divisor(f) = \sum_{c\in C(\bar k)} \order_c(f) \cdot c.
\]
We put $\picard(C)=\divisors(C)/\divisor(k(C)^\times)$. 

Now we need to define the canonical divisor. It is the class of a nonvanishing 
differential on $C$. More formally, it's the divisor class corresponding to the 
line bundle $\Omega_C^1$. 

We put $l(D)=\dim \sL(D)$, where 
\[
  \sL(D) = \{f:C\epic \dP^1:\divisors(f)+D\geqslant 0\} \cup \{0\}.
\]
It is a theorem that $l(D) < \infty$ for all divisors $D$. 

Aside: let $[L:\dQ]<\infty$, i.e.~let $L$ be a number field. Then there is an 
exact sequence 
\[\begin{tikzcd}
  0 \ar[r] 
    & \cO_L^\times \ar[r] 
    & L^\times \ar[r] 
    & I_L \ar[r] 
    & \picard(O_L) \ar[r] 
    & 0 ,
\end{tikzcd}\]
where $I_L$ is the group of fractional ideals in $L$. See 
\cite{lorenzini-1996} for more on the parallel between 
algebraic number theory and algebraic geometry. This is analogous to the 
sequence 
\[\begin{tikzcd}
  0 \ar[r] 
    & k^\times \ar[r] 
    & k(C)^\times \ar[r, "\divisor"] 
    & \divisors^\circ(C) \ar[r] 
    & \picard^\circ(C) \ar[r] 
    & 0 .
\end{tikzcd}\]
Here the degree $\deg(\sum n_c c) = \sum n_c$. It is a basic fact that for 
$f\in k(C)^\times$, we have $\deg(f)=0$. In fact, $\picard(X)$ makes sense 
for $X$ any scheme (e.g.~a curve or the spectrum of $\cO_L$). 

If $C_{/\dQ}$ is a smooth projective curve, then $C(\dC)$ will be a compact 
Riemann surface, hence a torus with $g$ holes. We call $g$ the \emph{genus} of 
$C$. Geometrically, $g=\dim \h^0(\Omega^1)$. 

\begin{theorem}\label{thm:basic-facts}
Let $C_{/k}$ be a smooth projective curve, $D$ a divisor on $C$. Then 
\begin{enumerate}
\item $\deg D<0\Rightarrow l(D)=0$. 
\item $l(D)<\infty$. 
\item $D\sim D'\Rightarrow \sL(D)\simeq \sL(D')$. 
\item $l(K_C)=g$ and $\deg(K_C)=2 g-2$. 
\item $\deg(D)>2 g-2\Rightarrow l(D)=\deg(D)-g+1$. 
\end{enumerate}
\end{theorem}
\begin{proof}Choose $D$ cleverly (i.e.~$0$ or $K_C$) in the Riemann-Roch 
Theorem, and use $l(0)=1$. 
\end{proof}





\subsection{Elliptic curves}

If we're analyzing the case $g=0$, diophantine properties were known to the 
Greeks. For $g\geqslant 2$, Faltings tells that $\#C(\dQ)<\infty$. The 
remaining case is $g=1$. 

\begin{definition}
Let $k$ be a field. An \emph{elliptic curve over $k$} is a smooth projective 
curve $E_{/k}$ together with a point $0\in E(k)$. 
\end{definition}

Let $E_{/k}$ be an elliptic curve, $e\in E(k)$. What is $l(e)$? From 
\autoref{thm:basic-facts}, we get: 
\begin{center}
\begin{tabular}{c|cl}
$n$ & $l(n\cdot e)$ & basic of $\sL(n\cdot e)$ \\ \hline
1 & 1 & $\{1\}$ \\
2 & 2 & $\{1,x\}$ \\
3 & 3 & $\{1,x,y\}$ \\
4 & 4 & $\{1,x,y,x^2\}$ \\
5 & 5 & $\{1,x,t,x^2,x y\}$ \\
6 & 6 & $\{1,x,y,x^2,x y, x^3\text{ or } y^2\}$ 
\end{tabular}
\end{center}
The last set could have seven elements, but $\sL(6\cdot e)$ is 
$6$-dimensional. It follows that there is a dependence relation 
\[
  \alpha_0 + \alpha_1 x + \alpha_2 y+ \alpha_3 x^2 + \alpha_4 x y+\alpha_5 x^3 + \alpha_6 y^2 = 0 .
\]
We claim that $(\alpha_4,\alpha_6)\ne (0,0)$. Basic consideration of the 
orders of poles in the remaining equation at $e$ shows this. We can assume that 
$\alpha_6\ne 0$. Say $\alpha_6=0$ (then $\alpha_4\ne 0$). Consider the change 
of variables 
\begin{align*}
  x &\mapsto x + cy \\
  y &\mapsto y. 
\end{align*}
The new coefficient of $y^2$ is $\alpha_3 c^2 + \alpha_4 c$, and we can choose 
$c$ so that this is $\ne 0$. There's a better proof that $\alpha_6\ne 0$. If 
$\alpha_6=0$, since $\{1,x,y,x^2,x y,x^3\}$ is a basis of $\sL(6\cdot e)$, all 
the $\alpha_i=0$, which we can assume is not the case. 

Divide through by $\alpha_6$ to get the following:
\[
  y^2 + y (\alpha_2+\alpha_4 x) + \left(\frac{\alpha_2+\alpha_4 x}{2}\right)^2 - \left(\frac{\alpha_2+\alpha_4 x}{2}\right)^2 + \alpha_3 x^3 + \alpha_1 x + \alpha_0 = 0 .
\]
Replace $y$ by $y+\frac{\alpha_2+\alpha_4 x}{2}$; we get: 
\[
  y^2 = \gamma_3 x^3 + \gamma_2 x^2 + \gamma_1 x + \gamma_2 .
\]
Replace $y$ by $\gamma_3^2 y$ and $x$ by $\gamma_3 x$; this gives 
$x^3$ and $y^2$ the same coefficient. Rescale and we get 
\[
  y^2 = x^3 + \delta_2 x^2 + \delta_1 x + \delta_0 .
\]
Replace $x$ by $x-\frac{\delta_2}{3}$, and we get an equation 
\[
  y^2 = x^3 + A x+B 
\]
with $A,B\in k$. 

Note we have used that $k$ has characteristic not $2$ or 
$3$. Completion of squares doesn't work in characteristic $2$, and the 
first step in solving cubics doesn't work in characteristic $3$. So in 
characteristic $3$, you can get $y^2=(\text{cubic})$, but for characteristic 
$2$, you can't really simplify the equation at all. In general, if $A$ is a 
$d$-dimensional abelian variety, it is noted in \cite{serre-tate-1968} that 
primes $p\leqslant 2 d+1$ can be especially nasty. 

We will need to reduce elliptic curves modulo $2$ and $3$. 
Given $E_{/\dQ}$, there is an integer $N$, called the \emph{conductor} of $E$, 
that measures the ``badness'' of the singularities in the reductions of $E$. 
For $p\geqslant 3$, we have $v_p(N)\leqslant 2$. For 
$p=3$, we just have $v_3(N)\leqslant 4$, and for $p=2$, we can have 
$v_2(N)=6$. 

We'll continue under the assumption that $k=\dQ$. Write our curve 
$E_{/\dQ}$ as 
\[
  y^2=x^3 + \frac{N_1}{D} x + \frac{N_2}{D} ,
\]
with $N_1,N_2,D\in \dZ$. Make the change of variables 
\begin{align*}
  x &\mapsto x/D^2 \\ 
  y &\mapsto y/D^3 .
\end{align*}
Then multiply through by $D^6$ and relabel. We get 
\[
  y^2=x^3+ A x+ B x ,
\]
with $A,B\in \dZ$. For any prime $p$, say 
$p^4\mid A$ and $p^6\mid B$. Make the change of variables
\begin{align*}
  x &\mapsto p^2 x \\ 
  y &\mapsto p^3 y .
\end{align*}
you can rescale again until one of these possibilities fail. We end up with 
a Weierstrass form $y^2=x^3+A x+B$ with $p^4\mid A\Rightarrow p^6\nmid B$. This 
is the \emph{minimal model} of $E$. 

Now we can study $E_{/\dQ}$ and write $E=E_{A,B}$, given by $y^2=x^3+A x+B$, 
for $A,B\in \dZ$ with $(p^4\nmid A\text{ or }p^6\nmid B)$. Recall that 
$E_{A,B}$ is singular exactly if 
\[
  \begin{pmatrix} 2 y & 3 x^2+A\end{pmatrix} = 0
\]
for some $(x,y)\in E(\overline\dQ)$. This can happen only if 
$27 B^2+4 A^3=0$. The set of such $(A,B)$ is thin. 

This procedure works over $\dZ[\frac 1 6]\subset \dZ$. 





\subsection{Group law on an elliptic curve}

Let $E_{/k}$ be an elliptic curve in strong Weierstrass form 
$y^2=x^3+A x+B$. We will give $E$ the structure of an abelian 
variety over $k$. We declare $P+Q+R=0$ if $P$, $Q$, and $R$ lie on the same 
line through $E$ in $\dP^2$. This determines a morphism 
$E\times E\to E$ defined over $k$. From the definition, it is clear that 
addition is commutative. We won't verify that the group law is associative. 
It can be directly, but this is very tedious. A more conceptual approach is to 
use the Picard variety. To summarize: 

\begin{theorem}
Let $E_{/k}$ be an elliptic curve given by $y^2=x^3+A x+B$. Then $E$ has the 
unique structure of an abelian variety such that $(0:1:0)$ is the identity 
element. 
\end{theorem}
\begin{proof}
Existence follows from the fact that the map $E\to \picard^0(E)$ is an 
isomorphism of varieties over $k$. Uniqueness follows from Proposition 1.13 of 
\cite{moonenABV}. 
\end{proof}

Let $P=(\alpha,\beta)$. What is $2 P=P+P$? We can implicitly differentiate 
$y^2=x^3+A x+B$ to get 
\[
  y' = \left.\frac{3 x^2+A}{2 y}\right|_{(\alpha,\beta)} = \frac{3\alpha^2+A}{2 \beta} .
\]
We can solve the equation 
\[
  \left(\beta+\frac{3\alpha^2+A}{2\beta}(x-\alpha)\right)^2 = x^3+A x+B ,
\]
to see that the third root is $\frac{(3\alpha^2+A)^2}{4\beta^2} - 2\alpha$. So 
\[
  x_{2 P} = \frac{(3\alpha^2+A)^2}{4(\alpha^3+A\alpha+B)} - 2\alpha ,
\]
and $y_{2 P}$ can be computed similarly. 

Given $Q=(\alpha,\beta)\in E(\overline K)$, let's find $P$ such that 
$2 P=Q$. Since $\# E[2](\overline K)=4$, we expect four such $P$. It comes down 
to solving the equation 
\[
  \frac{(3\alpha^2+A)^2}{4(\alpha^3+A\alpha+B)} - 2\alpha = r .
\]
The polynomial on the left has degree $4$, so there will indeed be four $P$. 

In general, given $Q\in E(\overline K)$, the equation $n P=Q$ has $n^2$ 
solutions, provided $n$ is invertible in $k$. Also, if $n$ is invertible in 
$k$, then $E[n]\simeq (\dZ/n)^2$, and $G_K=\galois(\overline K/K)$ acts on 
$E[n]$ by group automorphisms. This is really easy. To verify this, all we need 
to check is that $\sigma(P+Q)=\sigma(P)+\sigma(Q)$ for all $\sigma\in G_K$ and 
$P,Q\in E(\overline K)$. But $x_{P+Q}$ and $y_{P+Q}$ are rational functions in 
the coordinates of $P$ and $Q$, \emph{defined over $K$}. If 
$f\in K(t)$ is a rational function, then $\sigma(f(x))=f(\sigma(x))$ for all 
$x\in \overline K$, whence $\sigma(x_{P+Q})=x_{\sigma P+\sigma Q}$. 

Given $E_{/\dQ}$, set $a_p=p+1-\# E(\dF_p)$, where $E(\dF_p)$ is the 
$\dF_p$-points of the projective curve associated to $E$. Note that 
$p+1=\dP^1(\dF_p)$. Note that this only makes sense for $p\nmid \Delta$. 

\begin{theorem}[Hasse]
$|a_p|\leqslant 2\sqrt p$. 
\end{theorem}
Recall the $L$-function of $E$ is defined in terms of the $a_p$: 
\[
  L(E,p) = \text{(finite \# of terms)} \prod_{p\nmid \Delta} \left(1-\frac{a_p}{p^s} + \frac{p}{p^{2s}}\right)^{-1} .
\]
If $\Re s=\frac 3 2+\epsilon$, then 
\[
  \left|-\frac{a_p}{p^s} + \frac{p}{p^{2s}}\right| \leqslant \frac{2}{p^{1+\epsilon}}+\frac{1}{p^{2+2\epsilon}} \leqslant p^{-1-\epsilon/2} ,
\]
at least for $p\gg 0$. We know that $\prod (1-p^{-s})^{-1}$ converges for 
$\Re s>1$. Thus $L(E,s)$ is defined for $\Re s>3/2$. 

We know that $|a_p|\leqslant p+1$. This gives well-definedness of $L(E,s)$ for 
$\Re s>2$, and it isn't too hard to get $\Re s>3/2$. The following theorem was 
proved in the course of Wiles' proof of Fermat's Last Theorem. 

\begin{theorem}
$L(E,s)$ has a meromorphic continuation to $\dC$. 
\end{theorem}

Recall the weak Birch and Swinnerton-Dyer conjecture:

\begin{conjecture}
$\order_{s=1} L(E,s) = \rank E$. 
\end{conjecture}
Note that $\rank E$ is global data, while the $a_p$ only depend on the reduction 
$E_{/\dF_p}$. The following theorem was known as the Sato-Tate conjecture. 

\begin{theorem}[Taylor et.~al.]
Define $\theta_p$ by $\frac{a_p}{2\sqrt p} = \cos(\theta_p)$ and 
$\theta_p\in [-\pi/2,\pi/2)$. Then 
\[
  \lim_{X\to \infty}\frac{\#\{p\leqslant X:c\leqslant \theta_p\leqslant d\}}{\pi(X)} = \frac 2 \pi \int_c^d \sin^2(u)\, \mathrm{d} u .
\]
\end{theorem}
\begin{proof}
In \cite{serre-1968}, Serre outlined a strategy. It relied on 
$L(\symmetric^n E,s)$ being analytic at $1$ for infinitely many $n$. At the 
time, we didn't even know this for $n=1$! This requires a vast generalization 
of Wiles et.~al.~(who worked with $n=1$). 
\end{proof}

In some ways, the Sato-Tate conjecture is unsatisfying because it says that 
``all (non-CM) elliptic curves are the same.'' On the other hand, the Birch and 
Swinnerton-Dyer conjecture is about how local data of elliptic curves gives 
information about global data. 

\begin{conjecture}[Harris]
Let $E_1$, $E_2$ be non-isogenous (up to twist) elliptic curves over $\dQ$. 
Then the Sato-Tate distributions of $E_1$, $E_2$ are independent. 
\end{conjecture}

See \cite{harris-ST} for a careful statement and motivation. 
There is an obvious family to pairwise non-isogenous families 
$\{E_1,\cdots,E_n\}$, but there isn't a clear approach to prove this. 





\subsection{Kummer theory}

Let $K\subset L$ be a Galois field extension. There is a version of Galois 
theory for $G=\galois(L/K)$, but we need to give $G$ a topology. Let a basis 
of $1$ be the subgroups of the form $G_x=\stabilizer_G(x)$ for $x\in L$. Under 
this topology (the \emph{Krull topology}), the group $G$ is compact, Hausdorff, 
and totally disconnected. See Chapter IV of \cite{neukirch-1999} for details. 

Let $k$ be a field, $p$ a prime invertible in $k$ such that $\dmu_p\subset k$. 
Let $k^{(p)}$ be the composite of all $\dZ/p$-Galois extensions of $k$ in 
$\overline k$. 

\begin{theorem}
The pairing $\galois(k^{(p)}/k)\times k^\times/p \to \dmu_p$ given by 
\[
  \langle \sigma,x\rangle = \frac{\sigma(x^{1/p})}{x^{1/p}} 
\]
is a well-defined perfect pairing of topological groups. 
\end{theorem}
\begin{proof}
Say $\langle \sigma,x_0\rangle=1$ for all $\sigma\in \galois(k^{(p)}/k)$. Then 
$\sigma(x_0^{1/p})=x_0^{1/p}$ for all $\sigma$. This implies 
$x_0^{1/p}$ is fixed by $\galois(k^{(p)}/k)$, which implies 
$x_0^{1/p}\in k$, which implies $x_0\in (k^\times)^p$. 

Now suppose $\langle \sigma_0,x\rangle = 1$ for all $x\in k^\times$. So 
$\sigma_0(x^{1/p})=x^{1/p}$ for all $x\in k^\times$. In particular, $\sigma_0$ 
is trivial on $k(x^{1/p}:x\in k^\times)$. We want for this field to be 
$k^{(p)}$. It suffices to check that if $K/k$ is a $\dZ/p$-extension, then 
$K=k(x^{1/p})$ for some $x\in k$. Recall Hilbert's Theorem 90: an element 
$x\in K^\times$ satisfies $\norm_{K/k}(x)=1$ if and only if there exists $y$ 
such that $x=y/\tau(y)$, where $\tau$ is any generator of $\galois(K/k)$. Since 
$\norm_{K/k}(\zeta_p)=\zeta_p^p1$, we get $\zeta_p=y/\tau(y)$, so 
$\tau(y)=\zeta_p^{-1} y$. Since $y\in K\smallsetminus k$, we know that 
$K=k(y)$. But $\tau(y)=\zeta_p^{-1} y$ tells us that $y^p\in k$, so $K$ is 
generated by a $p$-th root of an element of $k$. 
\end{proof}

See \cite[IV \S 3]{neukirch-1999} for a proof. The theorem, correctly 
rephrased, works with arbitrary $n$ invertible in $k$. Hilbert's Theorem 90 is 
a very special case of the extremely general result that 
$\h^1(X_\etale,\Gm) = \picard(X)$ for any noetherian scheme $X$ 
\cite[I 2.2.3]{sga4-5}. 

As an example, for $p=2$ and $k=\dR$, we see that there is only one 
$\dZ/2$-extension of $\dR$. This can be used to show that $\dC$ has no solvable 
extensions. 

There is a purely geometric approach to Kummer theory. Let $X$ be a scheme 
on which $n$ is invertible. The \emph{Kummer exact sequence} is the sequence 
\[
  1 \to \dmu_n \to \Gm \xrightarrow n \Gm \to 1 
\]
of \'etale sheaves on $X$. The long exact sequence in sheaf cohomology gives 
us a short exact sequence: 
\[
  1 \to \sO(X)^\times/n \to \h^1(X,\dmu_n) \to \picard(X)[n] \to 1 .
\]
Since $\dmu_n\simeq \dZ/n$, we have $\h^1(X,\dmu_n)=\hom(\pi_1(X),\dZ/n)$. 
When $X=\spectrum(k)$, we have $\picard(X)=0$, so 
$k^\times/n\simeq \hom(G_k,\dZ/n)$. For arbitrary $X$, the Kummer exact 
sequence can be used to get a pretty good grasp of $\pi_1(X)^\mathrm{ab}$. 
See \cite[5.8.3]{szamuely-2009} for details. 

Kummer theory is used to study solvable extensions in classical algebraic 
number theory. More generally, it is used in class field theory to build the 
abelian extensions of a field. Finally, it is used in local and global duality 
theorems in the cohomology of $G_\dQ$, $G_{\dQ_l}$. 

The Weil pairing is a kind of ``geometric Kummer theory.'' It is a perfect 
pairing $E[m]\times E[m]\to \dmu_m$. This means that 
$E[m]\simeq \hom(E[m],\dmu_m)=E[m]^\vee$, the dual in the correct sense. So 
$E[m]$ is self-dual in some sense. Even better, 
$E[m]^\vee\simeq \h^1_\mathrm{et}(E,\dZ/m)$, and the Weil pairing is comes from 
the cup-product 
pairing in \'etale cohomology: 
\[
  \h^1(E,\dZ/m)\times \h^1(E,\dZ/m) \to \h^2(E,\dZ/m).
\]

\begin{example}
Let $p=2$ and $k=\dQ$. Then 
$\dQ^{(2)}=\dQ(\sqrt{-1},\sqrt{l}\text{ all prime }l)$. Note that 
\[
  \galois(\dQ^{(2)}/\dQ) \simeq \prod_{l,-1} \dZ/2 .
\]
On the other hand, $\dQ^\times/2 = \bigoplus_{l,-1} \dZ/2$. The point is that 
the Kummer pairing is between a discrete group and a (uncountable) compact 
group. 
\end{example}

In general, Galois groups are either finite or uncountable (because they're 
compact). There is one case in which we can explicitly describe the entire 
absolute Galois group of a field. 

\begin{theorem}
Let $\dF_q$ be the finite field of cardinality $q$. For each $n\geqslant 1$, 
there is a unique degree $n$ extension $\dF_{q^n}/\dF_q$. This extension satisfies 
$\galois(\dF_{q^n}/\dF_q)$. 
\end{theorem}
\begin{proof}
Find such $\dF_{q^n}$ in $\overline{\dF_q}$. It has cardinality $q^n$, and 
$\dF_{q^n}^\times\simeq \dZ/(q^n-1)$. Indeed, if it wasn't cyclic, then 
$x^{q^n}-1$ has too many roots in $\dF_{q^n}$. The splitting field of 
$x^{q^n}-x$ gives a degree $n$ extension of $\dF_q$, and this must be unique 
because any other degree-$n$ extension of $\dF_q$ must contain all 
$(q^n-1)$-th roots of unity. 
\end{proof}





\subsection{Weil pairing}

We start with some needed facts, which are proved using Riemann-Roch. Let 
$k$ be a field, $n\geqslant 2$ an integer invertible in $k$, and let 
$E_{/k}$ be an elliptic curve. Suppose $D=\sum n_x(x)$ is a divisor on $E$. 
\begin{enumerate}
\item
If $\deg(D)=0$, then $D=\divisor(f)$ for some rational function $f$ on $E$ if 
and only if $\sum [n_x] x=0$ as an element of $E(\overline k)$. 

\item
If $x\ne 0$ in $E$, then $(x)-(0)\ne \divisor(f)$ in $\picard^\circ(E)$. 
\end{enumerate}

Given $x,y\in E[n]$, we'll define $e_n(x,y)\in \dmu_n$ following 
\cite[III \S 8]{silverman-2009}. By fact 1 above, the divisor 
$D=n(y)-n(0)$ is $\divisor(f)$ for some function $f$ on $E$. Let $y'$ be such 
that $[n]y'=y$, and consider 
\[
  [n]^\ast D = \sum_{z\in E[n]} (y'+z)-(z) ,
\]
where $y'+z$ is defined using the addition in $E$. This is a degree-$0$ 
diivisor, and within $E$, we have $\sum_{z\in E[n]}(y'+z-z)=n^2 y' = n y = 0$. 
Thus $[n]^\ast D=\divisor(g)$ for some $g$, and it is easy to check that we 
must have $f = c g^n$ for some $c\in \overline k$. We can replace $g$ by a 
scalar multiple to get $f=g^n$. Note that 
$g(t+x)^n = f([n] t+[n] x) = f([n] t) = g(t)^n$. Thus we can define 
\[
  e_n(x,y) = \frac{g(t+x)}{g(t)}
\]
for any $t$ in the domain of $g$. Note that this definition is 
asymmetric with respect to $x,y$. Also $f,g$ are independent of $y$. 

\begin{theorem}
Let $E_{/k}$ be an elliptic curve. Then: 
\begin{enumerate}
  \item $e_n(x_1+x_2,y) = e_n(x_1,y) e_n(x_2,y)$ 
  \item $e_n(x,y_1+y_2) = e_n(x,y_1) e_n(x,y_2)$ 
  \item $e_n(x,x)=1$, so $e_n(x,y) = e_n(y,x)^{-1}$ 
  \item $e_n(x,y)^\sigma = e_n(x^\sigma,y^\sigma)$ for all $\sigma\in G_k$. 
  \item $e_n(x,y)=1$ for all $x$ implies $y=0$, and vice versa. 
\end{enumerate}
\end{theorem}
\begin{proof}
This is Proposition III.8.1 in \cite{silverman-2009}. 

1. We have 
\begin{align*}
  e_n(x_1+x_2,y) 
    &= \frac{g(t+x_1+x_2)}{g(t)} \\
    &= \frac{g((t+x_1)+x_2)}{g(t+x_1)} \frac{g(t+x_1)}{g(t)} \\
    &= e_n(x_1,y) e_n(x_2,y) .
\end{align*}
The other part is more involved. Call $y_3=y_1+y_2$. Let 
$f_i,g_i$ be the functions for $y_i$. We must relate $g_3$ to $g_1,g_2$. 
Put $D=(y_3)-(y_1)-(y_2)+(0)$; this has degree $0$, and the sum of its points 
is $0$ in $E$, so $D=\divisor(h)$ for some $h$. Recall that 
$\divisor(f_i) = n(y_i) - n(0)$. Thus 
\[
  \divisor\left(\frac{f_3}{f_1 f_2}\right) = \divisor(h^n) .
\]
Thus $f_3=c f_1 f_2 h^n$ for some $c$. It follows that 
$f_3\circ [n] = c f_1\circ [n] f_2\circ [n] (h\circ [n])^n$, so 
$g_3^n = g_1^n g_2^n (h\circ [n])^n$. Take $n$-th roots: we get 
$g_3 = \widetilde c g_1 g_2 (h\circ [n])$. We can now compute: 
\begin{align*}
  e_n(x,t_3) 
    &= \frac{g_3(t+x)}{g_3(t)} \\
    &= \frac{g_1(t+x)g_2(t+x)h([n] t+[n] x)}{g_1(t) g_2(t) h([n] t)} \\
    &= e_n(x,y_1) e_n(x,y_2) .
\end{align*}

4. We compute 
\[
  e_n(x,y)^\sigma 
    = \left(\frac{g(t+x)}{g(t)}\right)^\sigma 
    = \frac{g^\sigma(t^\sigma+x^\sigma)}{g^\sigma(t^\sigma)} 
    = e_n(x^\sigma,y^\sigma) .
\]

We leave the rest of the proof as an exercise. 
\end{proof}

The alternating property and Galois-equivariance of the Kummer pairing have a 
nice consequence. Choose a generating set $x,y\in E[n]$, $\sigma\in G_k$. Then 
$\sigma$ acts on $E[n]$ via some matrix 
$\begin{pmatrix} a & b \\ c & d \end{pmatrix}\in \GL_2(\dZ/n)$ 
with respect to the basis $\{x,y\}$. Suppose $e_n(x,y)=\zeta\in \dmu_n$. Then 
$\sigma(\zeta) = \zeta^{\chi(\sigma)}$, where $\chi:G_k\to \GL_1(\dZ/n)$ is 
the cyclotomic character. Write $\rho_{E,n}:G_k\to \GL_2(\dZ/n)$ for the 
representation coming from $E$. We claim that $\det\rho_{E,n} = \chi_n$. All 
we need to show is that $e_n(x,y)^\sigma = \zeta^\sigma = \zeta^{a d-b c}$. We 
know that $e_n(x,y)^\sigma = e_n(x^\sigma,y^\sigma) = e_n(a x+c y, b x+d t)$; 
we're left with $e_n(x,y)^{a b-c d}$, as desired. 

The Weil pairing makes $E[n]$ self-dual as a representation of $G_k$. 
Let $X_{/k}$ be a smooth projective curve. There is a canonical pairing 
(``cup-product''): 
\[
  \h_\etale^1(X,\dmu_n)\times \h_\etale^1(X,\dmu_n) \to \h_\etale^2(X,\dmu_n) = \dmu_n .
\]
Moreover, $\h_\etale^1(X,\dmu_n) \simeq \jacobian(X)[n]$, where $\jacobian(X)$ 
is the \emph{Jacobian} of $X$, a $g$-dimensional abelian variety containing 
$X$. Thus $\jacobian(X)$ has a group structure, while $X$ does not. 

The algebraic analogue of the notion of a local diffeomorphism is a 
\emph{finite \'etale cover}. It turns out that $\jacobian(X)[n]$ parameterizes 
degree-$n$ finite \'etale covers of $X$ with abelian Galois group. There is a 
``Weil pairing'' on $\jacobian(X)$ coming from the Poincar\'e bundle, but it 
agrees with the cup-product. 

There is an analogy between Kummer theory and the Weil pairing. Recall that if 
$k$ is a field of characteristic not $p$ which contains all $p$-th roots of 
unity, and if $k^{(p)}$ is the maximal abelian $p$-extension of $k$, then the 
obvious pairing $\galois(k^{(p)}/k)\times k^\times/p \to \dmu_p$ is perfect. 





\subsection{Isogenies}

An \emph{isogeny} will be morphisms between elliptic curves, defined over the 
base field. Since elliptic curves are varieties, we should require these 
morphisms to be polynomial (or rational). Since elliptic curves have a group 
law, we also want these morphisms to respect this structure. Summing up: if we 
think of elliptic curves as group objects in the category of projective 
varieties (projective $\Rightarrow$ abelian), an isogeny is a non-constant 
morphism of such objects. More formally, 

\begin{definition}
Let $E_1,E_2$ be elliptic curves over $k$, $\phi:E_1\to E_2$ a morphism. We say 
$\phi$ is an \emph{isogeny} if it is a dominant morphism of varieties, and 
satisfies $\phi(0)=0$. 
\end{definition}

It turns out that if $\phi$ is an isogeny, then $\phi$ is actually a morphism 
of group schemes. 
If $\phi:E_1\to E_2$ is defined over $k$, then $\ker\phi$ is $G_k$-stable as a 
group (not pointwise). Given $E_{/\dQ}$ and an isogeny $\phi:E\to E$, usually 
$\phi$ is $[n]$ for some $n\in\dZ\smallsetminus 0$. 
When there are isogenies not of this form, amazing congruences happen. 

\begin{example}
Let $\Delta=q \prod_{n\geqslant 1} (q-1^n)^{24} = \sum \tau(n) q^n$; the first 
few terms are: 
\[
  \Delta = q-24 q^2 + 252 q^3 - 1472 q^4 + 4830 q^5 - 6048 q^6 + \cdots .
\]
Ramanujan observed that $(m,n)=1$ implies $\tau(m n) = \tau(m) \tau(n)$. He 
also observed that for a prime $p$, 
$\tau(p^{r+1}) = \tau(p) \tau(p^r) - p^{11} \tau(p^{r-1})$. Also, 
$|\tau(p)|\leqslant 2 p^{11/2}$ (this is hard: it was proved by Deligne in the 
course of the Weil conjectures). Finally, 
\[
  \tau(n) \equiv \sigma_{11}(n) = \sum_{d\mid n} d^{11} \pmod{691} .
\]
This congruence is a manifestation of the ``existence of a non-trivial 
isogeny.'' 
\end{example}

This example is one of the first cases of a congruence between a \emph{cusp 
form} and \emph{Eisenstein series}. The first paper to make much use of this 
idea is \cite{ribet-1976}, in which Ribet used modular forms to prove the 
converse of Kummer's criterion. The ideas here were crucial in the proof of 
Iwasawa's Main Conjecture, Skinner and Urban's recent work, and many other 
parts of modern number theory. See Mazur's survey article 
\cite{mazur-2011} for an excellent overview of this circle of ideas. 

If $V_{/k}$ is an irreducible variety, it has a function field $k(V)$. If 
$\phi:V\to W$ is a morphism of varieties, there is a inclusion 
$\phi^\ast:k(W)\to k(V)$, assuming $\phi$ is surjective. So the Frobenius 
$\dP_{/\dF_p}^1\to \dP_{/\dF_p}^1$ sending $(x_0:x_1)$ to 
$(x_0^p:x_1^p)$ induces a map 
$\dF_p(t)\to \dF_p(t)$, $f(t)\mapsto f(t^p)$. The field extension 
$\dF_p(t^{1/p})/\dF_p(t)$ is purely inseparable, and has degree $p$. In 
characteristic $p$, the geometric Frobenius $\Frob:E\to E$ an isogeny, but 
\emph{not} an isomorphism of varieties, as ``the inverse'' involves taking 
$p$-th roots. It turns out that $\Frob$ has degree $p$, and is purely 
inseparable. 

In characteristic zero, $\deg(\phi)$ is $\# \phi^{-1}(x)$ for ``generic'' 
$x$, and $[k(E_1):\phi^\ast k(E_2)]$ in characteristic $p$. One has to check 
that these two quantities agree in characteristic zero. If $V_{/\dF_q}$ is a 
$d$-dimensional variety, then $\Frob_q:V\to V$ has degree $q^d$. 

Let $E_{/\dQ}$ be an elliptic curve. Consider an isogeny 
$\phi:E\to \widetilde E$ of degree $p$ defined over $\dQ$. Since 
$\#\ker(\phi)=p$, we have $\ker(\phi)\subset E[p]$. Moreover, $\ker(\phi)$ is 
stable under the action of $G_\dQ$. Note that $\widetilde E=E/\ker\phi$. So we 
have a pair $(E,C)$, where $E_{/\dQ}$ is an elliptic curve, and $C\subset E$ is 
a subgroup of order $p$ defined over $\dQ$. Alternatively, we could study pairs 
$(E,P)$, where $E_{/\dQ}$ is an elliptic curve and $P\in E[p](\dQ)$ has order 
$p$. Since $G_\dQ$ acts on $E[p]$, we have a representation 
$\rho:G_\dQ\to \GL_2(\dZ/p)$. In the first case, the image fits inside 
$\begin{pmatrix} \ast & \ast \\ & \ast \end{pmatrix}$, and in 
the second case it looks like 
$\begin{pmatrix} 1 & \ast \\ & \varepsilon\end{pmatrix}$, 
where $\varepsilon:G_\dQ\to \dF_p^\times$ must be the cyclotomic character, 
defined by $\sigma(\zeta_p) = \zeta_p^{\varepsilon(\sigma)}$. 

There are moduli spaces for pairs $(E,C)$ and $(E,P)$ as above, namely the 
modular curves $Y_0(p)_{/\dQ}$ and $Y_1(p)_{/\dQ}$. There is a natural 
isomorphism $Y_0(p)(\dC) = \fH/\Gamma_0(p)$, where 
\[
  \Gamma_0(p) = \left\{\begin{pmatrix} a & b \\ c & d \end{pmatrix}\in \SL_2(\dZ):c\equiv 0\pmod p\right\} .
\]
The curve $Y_0(p)$ is affine; let $X_0(p)$ be its compactification. The 
classification of pairs $(E,C)$ defined over $\dQ$ comes down to the study of 
$Y_0(p)(\dQ)$. The complex points of $Y_1(p)$ are in bijection with 
$\fH/\Gamma_1(p)$, where 
\[
  \Gamma_1(p) = \left\{\gamma\in \SL_2(\dZ):\gamma\equiv \begin{pmatrix} 1 & \ast \\ & 1 \end{pmatrix} \pmod p\right\} .
\]

\begin{theorem}[Mazur]
$Y_0(p)(\dQ)=\varnothing$ for all $p\geqslant 11$. 
\end{theorem}

This implies that there does not exist an $E_{/\dQ}$ and (for $p\geqslant 11$) 
$P\in E(\dQ)$ of order $p$. This theorem is proved in the seminal paper 
\cite{mazur-1977}. This allows the classification of $E(\dQ)_\mathrm{tors}$ for 
$E_{/\dQ}$. Mazur's theorem tells us that $p\nmid E(\dQ)_\mathrm{tors}$ for 
$p\geqslant 11$. All that remains are the primes $p<11$, and this is a finite 
list. 

Note that an isogeny can be given by a pair $(E,C)$, where $E_{/k}$ is an 
elliptic curve and $C_{/k}$ is a subgroup scheme of $E$. The quotient $E/C$ 
must be defined in the appropriate sense -- this can get pretty complicated. 

Are isogenies ramified? Let's restrict to characteristic zero. We are asking: 
if $\phi:E_1\to E_2$ is an isogeny, are there points $x\in E_2(\bar k)$ such 
that $\#\phi^{-1}(x)< \deg(\phi)$? The answer is no: isogenies are \'etale, 
hence unramified. This is because $\phi$ is a group homomorphism, so 
$\#\phi^{-1}(x) = \# \phi^{-1}(0) = \deg(\phi)$ for all $x$. If 
$\phi:C_1\to C_2$ is a map between curves over $k$, then if one of the curves 
isn't elliptic, it's possible for $\phi$ to have ramification points. The 
Riemann-Hurwitz formula gives us a bound on possible ramification. 





\subsection{Jacobians}

Let $C_{/k}$ be a curve. The \emph{Jacobian} of $C$, denoted $\jacobian(C)$, 
is a group variety build from $C$, which has a natural map $C\to \jacobian(C)$. 
If $C$ has genus $g$, then $\jacobian(C)$ is $g$-dimensional. 

The \emph{divisor group} of $C$, denoted $\divisors(C)$, is the free abelian 
group on $C(\bar k)$. It contains a subgroup $\divisors^\circ(C)$ consisting 
of degree-zero divisors. There is a smaller subgroup of \emph{principal 
divisors}, which are of the form $\divisor(f)$ for $f\in k(C)^\times$. One can 
show that $\deg(\divisor(f))=0$ for all such $f$. Define 
$\picard^\circ(C)$ to be the quotient 
$\divisors^\circ(C)/\divisor(k(C)^\times)$. 

\begin{theorem}
Let $C_{/k}$ be a genus-$g$ curve. Then $\picard^\circ(C)$ naturally has the 
structure of the $\bar k$-points of a $g$-dimensional abelian variety over $k$. 
\end{theorem}

Note that we've only constructed $\jacobian(C)$ as an abstract group. The 
underlying variety can be quite complicated. See \cite{kleiman-2005} for a 
survey of general Picard schemes. 

\begin{example}
Work over $\dC$. An elliptic curve $E_{/\dC}$ is just a complex torus. Let 
$L_1,L_2$ be generators for $\pi_1(E)$. Since $E$ has genus $1$, the space of 
holomorphic differential forms is one-dimensional, spanned by $\omega$. Let 
$A_i=\int_{L_i} \omega$. Then $\dC/\langle A_1,A_2\rangle\simeq E(\dC)$. 
\end{example}

If $C$ has genus $g\geqslant 2$, there are $2 g$ loops $L_1,\dots,L_{2 g}$ and 
$g$ holomorphic differentials $\omega_1,\dots,\omega_g$. One gets 
$\jacobian(C)(\dC) = \dC^g / \Lambda$, where $\Lambda$ is the lattice spanned 
by the vectors 
\[
  \int_{L_i} \begin{pmatrix} \omega_1 \\ \vdots \\ \omega_g \end{pmatrix}\qquad (1\leqslant i \leqslant 2 g ).
\]

Back to an elliptic curve $E_{/k}$. There is a map 
$\kappa:E\to \picard^\circ(E)$; this is an isomorphism. It sends 
$x\in E$ to the divisor $(x)-(0)$. If $\phi:E_1\to E_2$ is an isogeny, it 
induces a map $\phi^\ast:\picard^\circ(E_2)\to \picard^\circ(E_1)$ by 
pullback of divisors: $D\mapsto \phi^\ast D$, where 
\[
  \phi^\ast \sum n_x(x) = \sum n_x \phi^{-1}(x) .
\]
We can use our isomorphisms $E_i\iso \picard^\circ(E_i)$ to get an isogeny 
$\phi^\vee:E_2\to E_1$, given by 
$\phi^\vee = \kappa_1^{-1}\circ \phi^\ast\circ \kappa_2$. We call 
$\phi^\vee:E_2\to E_1$ the \emph{dual isogeny} to $\phi$. We have not (and will 
not) checked, but it is true, that: 
\begin{itemize}
  \item $\picard^\circ(C)$ is a smooth projective variety over $k$. 
  \item $\kappa$ is an isomorphism of varieties. 
  \item $\phi^\vee$ is an isogeny. 
\end{itemize}

It turns out that $\deg:\hom_k(E,E)\to \dN$ is a positive definite quadratic 
form. This depends on the fact that $\phi^\vee\circ\phi=[\deg\phi]$. The 
degree map is clearly positive-definite. To show that it's a quadratic form, 
just check that $\deg(\phi+\psi)-\deg(\phi)-\deg(\psi)$ is bilinear. We can 
compute: 
\begin{align*}
  (\phi+\psi)^\vee(\phi+\psi) - \phi^\vee \phi - \psi^\vee \psi 
    &= \phi^\vee\phi + \psi^\vee \phi + \phi^\vee \psi + \psi^\vee \psi - \phi^\vee \phi - \psi^\vee \psi \\
    &= \phi^\vee \psi - \psi^\vee  \phi ,
\end{align*}
which yields the desired result. 

In general, if $d:A\to \dZ$ is a positive definite quadratic form for 
some abelian group $A$, then 
$|d(\psi-\phi)-d(\psi)-d(\phi)|\leqslant 2\sqrt{d(\phi)d(\psi)}$. This is 
basically Cauchy-Schwarz. 

\begin{theorem}
Let $E_{/\dF_q}$ be an elliptic curve. Then $|\#E(\dF_q)-q-1|\leqslant 2\sqrt q$. 
\end{theorem}
\begin{proof}
Given $E_{/\dF_q}$, the map $\Frob_q-1$ is separable. Moreover, 
$\ker(\Frob_q-1) = E(\dF_q)$. Now we use Cauchy-Schwarz for the isogenies 
$\phi=\Frob$, $\psi=1$. We get 
\begin{align*}
  |\#E(\dF_q)-q-1| 
    &=|\deg(\Frob-1)-\deg(\Frob)-\deg(1)| \\
    &\leqslant 2\sqrt{\deg(\Frob)\deg(1)} \\
    &= 2\sqrt{1\cdot q} .
\end{align*}
\end{proof}

This is a real theorem. A Putnam exam had the following question: 
consider the equation $y^2=x^3+A x+B$ for $A,B\in \dZ$. Show that there exist 
solutions modulo $p$ for all $p$. Assume the induced (projective) curve $E$ 
is smooth. It is also true that $E_{/\dF_p}$ is smooth for all but finitely 
many $p$. For these good $p$, we know that 
$|\# E(\dF_p) - p - 1|\leqslant 2\sqrt p$. The curve $E$ has no affine 
solutions only when $\# E(\dF_p)=1$, which gets $1<2/\sqrt p$. This gives us 
the solution for all $p$ of good reduction. 

Note that as $q\to \infty$, we get $\# E(\dF_q) \sim q+1$, which clearly goes to 
infinity. So for $q$ large, \emph{all} $E_{/\dF_q}$ will have nonzero points. 
If $(6,q)=1$, then $E_{/\dF_q}$ is of the form $y^2=x^3+A x+B=f(x)$. Define a 
character $\chi:\dF_q\to \dZ$ by 
\[
  \chi(x) = \begin{cases} 1 & x\in (\dF_q^\times)^2 \\ -1 & x\notin (\dF_q^\times)^2 \\ 0 & x=0 \end{cases}.
\]
We have 
\[
  \# E(\dF_q) = 1 + \sum_{x\in \dF_q}\left(\chi(f(x))+1\right) = q+1 + \sum_{x\in \dF_q} \chi(f(x)) .
\]
So there is some finite Fourier analysis going on here -- this has a distant 
relation with the Langlands program. Recall that in characteristic $p$, if you 
want a degree $p$ separable extension, you don't study $x^p-\alpha$ -- rather, you 
study Artin-Schreier theory and study equations of the form $x^p-x-\alpha$. In 
general, we want \emph{separable} polynomials, where $g$ is separable if 
$(g,g')=1$. 

\begin{theorem}
No elliptic curve $E_{/\dQ}$ given by $y^2=x^3+A x+B$ with $A,B\in \dZ$ has 
good reduction at all primes, i.e.~is smooth modulo $p$ for all $p$. 
\end{theorem}
\begin{proof}
For $E$ to be smooth modulo $p$ for all $p$, we need $x^3+A x+B$ to have 
distinct roots modulo $p$ for all $p$. Let $\alpha,\beta,\gamma$ be the roots, 
and set $\Delta=\left((\alpha-\beta)(\beta-\gamma)(\gamma-\alpha)\right)^2$. 
You can check that $\Delta=\pm (4 A^3+27 B^2)$. If $\Delta\notin \{\pm 1\}$, 
then some prime $p\mid\Delta$, which means that $E_{/\dF_p}$ is singular. So 
we need $\Delta=\pm 1$, which gives $4 A^3\equiv \pm 1\pmod 9$. This means 
$x^3\in \{0,\pm 1\}\pmod 9$, and there is no way that 
$0,\pm 4$ can be congruent to $\pm 1$ modulo $9$. 
\end{proof}

It is known that there are finite extensions $L/\dQ$ and elliptic 
schemes $E_{/\cO_L}$. On the other hand, we have the following: 

\begin{theorem}[Fontaine]
There are no abelian varieties over $\dZ$. 
\end{theorem}
\begin{proof}
See Fontaine's beautiful paper \cite{fontaine-1985}. 
\end{proof}

% exercise: Consider the elliptic curve $y^2=x^3+3 x+1$. Find $\# E(\dF_{5^3})$. 

Let $k$ be a field of characteristic $p$ and $E_{/k}$ be an elliptic curve 
$y^2=x^3+a x+b$. Then $\Frob_q$ is \emph{not} a morphism $E\to E$. Rather, it 
is a morphism $E\to E^{(q)}$, where $E^{(q)}$ has Weierstrass equation 
$y^2=x^2+a^q x+b^q$. When $k\subset \dF_q$, then $a^q=a,b^q=b$, so 
$\Frob_q$ is actually a morphism $E\to E$. 

We've looked informally at the reduction of $E_{/\dQ}$ modulo $p$. This can be 
done directly via the Weierstrass equations. The relation between an elliptic 
curve and its Weierstrass equation is analogous to the relation between a 
vector space and its basis. Often, when proving (and computing) facts in 
linear algebra, we want to use bases, but basis-free proofs are often cleaner. 
In algebraic geometry, it is often possible to prove the same theorems about 
elliptic curves without using Weierstrass equations, but this requires more 
algebraic machinery in general. 

If $\phi:E\to E$ is an isogeny, then $e_m(\phi^\vee(x),y) = e_m(x,\phi(y))$ for 
all $x,y\in E[m]$. So $\phi$ is ``self-adjoint'' as an operator on 
$E[m]\simeq (\dZ/m)^2$. It would be nice to have an operator in characteristic 
zero. Define 
\[
  \tate_l E = \varprojlim E[l^n] \simeq \varprojlim (\dZ/l^n)^2 \simeq \dZ_l^2 .
\]
The ring $\dZ_l$ is a complete discrete valuation ring of characteristic zero. 
It is uncountable, and contains $\dZ$ as a dense subring. Elements can be 
written as $\sum_{n\geqslant 0} a_n p^n$, where $a_n\in \{0,\dots,l-1\}$, but 
this isn't very helpful. Isogenies of $E$ act on $\tate_l E$ by linear 
transformations. So we have a representation $\End(E)\to \matrices_2(\dZ_l)$. 
Usually, for $k$ a number field, $\End(E)\simeq \dZ$. Rarely, 
$\End(E)\otimes\dQ\simeq \dQ(\sqrt{-d})$ for some $d\in \dN$. For $k$ of 
characteristic $p$, $\End(E)\otimes \dQ$ will either be a quadratic imaginary 
field or a quaternion algebra. 

\begin{theorem}[Faltings]
Let $k$ be a number field, $E_{/k}$ an elliptic curve. Then 
$\End(E)\otimes \dZ_l\iso \End_{\dZ_l[G_k]}(\tate_l E)$. 
\end{theorem}

This theorem is highly non-trivial, and holds for arbitrary abelian varieties 
over a global field. The Tate module $\tate_l E$ with its Galois action, 
``knows'' $L(E,s)$, which (if we believe BSD) ``knows'' $\rank(E)$. Faltings 
proved that $\tate_l E$ determines $E$ up to isogeny. 

\begin{proposition}
Suppose $\phi:E_1\to E_2$ is an isogeny and $\ker\phi\supset E_1[n]$. Then 
there exists $\psi:E_1\to E_2$ such that $\phi=\psi\circ[n]$. 
\end{proposition}
\begin{proof}
Cite source.
\end{proof}

\begin{proposition}
Let $E$ be an elliptic curve. Then $\End(E)\otimes\dQ$ is either $\dQ$, 
an imaginary quadratic field, or a quaternion algebra. 
\end{proposition}
\begin{proof}
Recall that in general, $\hom(E_1,E_2)\monic \hom(\tate_l E_1,\tate_l E_2)$. Note 
that $\hom(\tate_l E_1,\tate_l E_2)$ is a rank-$4$ $\dZ_l$-module. So 
$\End(\tate_l E)\simeq \dZ^4$, and thus $\End(E)\otimes\dZ_l$ is a 
$\dZ_l$-module of rank at most $4$. We know that $\End(E)$ is an integral 
domain. Indeed, isogenies have finite kernel, so the composite of two 
isogenies has finite kernel. In particular, there is no way that two 
non-zero endomorphisms of $E$ can have trivial composite. If we knew that 
$\End(E)$ was finitely generated as an additive group, we would know it 
was free. We could use the injection $\End(E)\monic \dZ_l^4$ to conclude that 
$\rank(\End E)\leqslant 4$. It is a purely algebraic result that any 
(possibly non-commutative) integral domain of rank $\leqslant 4$ with an 
anti-involution is one of our three choices, after tensoring with $\dQ$. 
The anti-involution here is $\phi\mapsto \phi^\vee$. 

All that remains is to prove that $\End(E)$ is finitely generated. More 
generally, we'll prove that $\hom(E_1,E_2)$ is finitely generated. 
Let $M\subset \hom(E_1,E_2)$ be finitely generated. Set 
$M^\mathrm{div}=\{\phi:[n]\circ\phi\in M\text{ for some }n\in \dN\}$. Recall 
$\deg:M\to \dZ$; we can extend this to the finite-dimensional vector space 
$M_\dR=M\otimes\dR$, getting $\deg:M_\dR\to \dR$. Set 
$U=\{\phi\in M_\dR:\deg\phi<1\}$; this is an open neighborhood of zero in 
$M_\dR$. Also, 
$M^\mathrm{div}\subset M_\dR$, and $M^\mathrm{div}\cap U=0$ as isogenies have 
degree $\geqslant 1$. Thus $M^\mathrm{div}$ is discrete in 
$M_\dR$, which is finite-dimensional because $M$ is finitely generated. 
It follows that $M^\mathrm{div}$ is finitely generated. 
[haven't proved $\hom$ is f.g.]

Also, we'll prove 
$\hom(E_1,E_2)\otimes\dZ_l\monic \hom(\tate_l E_1,\tate_l E_2)$. Let 
$\phi\in \hom(E_1,E_2)\otimes\dZ_l$ be such that $\phi_l=0$. Let 
$\phi_1,\dots,\phi_t$ be a basis of $M^\mathrm{div}$. [We can assume 
$\phi\in M\otimes\dZ_l$. Now $M^\mathrm{div}$ is finitely generated; 
say it has basis $\phi_1,\dots,\phi_t$. Thus we can write 
$\phi=\sum \alpha_i \phi_i$ with the $\alpha_i\in \dZ_l$. Choose 
$\beta_i\in \dZ$ such that $\beta_i\equiv \alpha_i\pmod{l^n}$. Since 
$\phi_l=0$, $\phi_l$ kills all $l$-power torsion. This implies 
$\beta_i\equiv 0\pmod{l^n}$. But $n$ was arbitrary, so each 
$\alpha_i=0$. Thus $\rank_{\dZ_l}\hom(E_1,E_2)\otimes\dZ_l\leqslant 4$. 

Now we need to show that $\hom(E_1,E_2)$ is finitely generated. 
\end{proof}

[Aside: $\dQ(\mu_{p^\infty})/\dQ$ has Galois group 
$\dZ_p^\times\simeq \dZ/(p-1)\times \dZ_p$. So we should have a 
$\dZ_p$-extension $L$ of $\dQ$. The theorem is that there exists a 
unique $\dZ_p$-extension of $\dQ$. In general, if $k$ is a number field, 
take the composite $L$ of all $\dZ_p$-extensions of $k$. Its Galois 
group over $k$ will be $\dZ_p^r$ for some $r$. The famous 
\emph{Leopoldt conjecture} is that $r=r_2+1$, where $r_2$ is the number of 
complex places of $k$. This is known for $k/\dQ$ abelian. There are two 
famous theorems about $\cO_k$ and $\cO_k^\times$. One is that 
$\picard(\cO_k)$ is finitely generated, and the other is that $\cO_k^\times$ 
is finitely generated -- a product of its torsion subgroup and 
$\dZ^{r_1+r_2-1}$. 

Now $\cO_k^\times \monic \prod_{\fp\mid p} \cO_{k,\fp}^\times$. Leopoldt's 
conjecture is true exactly if $\dZ$-independent elements of 
$\cO_k^\times$ become $\dZ_p$-independent in 
$(\cO_k\otimes \dZ_p)^\times$. Is this known for any non-solvable 
extensions of $\dQ$?]

[Further aside: Let $h=\#\picard(\cO_k)$, $R$ be the volume of a fundamental 
domain of generators for $\cO_k^\times$. Then $h R$ is ``easy'' to numerically 
approximate via the clas number formula. Finding either individually is 
quite hard.]


\begin{proposition}
Let $E_{/k}$ be an elliptic curve, $\psi:E\to E$ be an isogeny. Then 
$\det(\psi,\tate_l E) = \deg(\psi)\in \dZ$ and 
$\trace(\psi,\tate_l E) = 1+\deg\psi-\deg(1-\psi)$. 
\end{proposition}
\begin{proof}
Write $\psi_l$ for $\psi$ considered as an endomorphism of $\trace_l E$.. 
We can write 
$\psi_l=\begin{pmatrix} a & b \\ c & d \end{pmatrix}\in \matrices_2(\dZ_l)$ 
with respect to some basis. We'll use $\varprojlim e_{l^n}$ to get a pairing 
$e:\tate_l E\times \tate_l E\to \varprojlim \dmu_{l^n} = \tate_l \Gm$. We now 
compute 
\begin{align*}
  e(v_1,v_2)^{\deg\psi} 
    &= e([\deg\psi]v_1,v_2) \\
    &= e(\psi_l^\vee\psi_l v_1,v_2) \\
    &= e(\psi_l v_1,\psi_l v_2) \\
    &= e(a v_1+c v_2, b v_1+d v_2) \\
    &= e(v_1,v_2)^{a d-b c} \\
    &= e(v_1,v_2)^{\det(\psi_l)} .
\end{align*}
Since the Weil pairing is perfect, this forces $\deg\psi=\det(\psi_l)$. 

In general, we know that for any $2\times 2$ matrix $\theta$, we have 
\begin{equation*}\label{eq:trace-id}
  \trace(\theta)=1+\det(\theta)-\det(1-\theta); 
\end{equation*}
so we're done. 
\end{proof}

Let's apply this result to $\Frob_5$ on $E_{/\dF_5}:y^2=x^3+3 x+1$. We know 
$\deg(\Frob_5)=5$. Consider the characteristic polynomial 
$\det(T-\Frob_5,\tate_l E)$; it has two roots $\alpha,\beta$. We know that 
$\alpha\beta=\deg(\Frob_5)=5$. From our identity \eqref{eq:trace-id} with 
$\theta=\Frob_{5,l}$, we get 
$\alpha+\beta=1+5-\det(1-\Frob_{5,l}) = 6-\# E(\dF_5)$. Consider the following 
table: 
\begin{center}
\begin{tabular}{c|cc}
$x$ & $x^3+3 x+1$ & $\#\sqrt{x^3+3 x+1}$ \\ \hline
0 & 1 & 2 \\
1 & 0 & 1 \\
2 & 0 & 1 \\
3 & 2 & 0 \\
4 & 2 & 0 
\end{tabular}
\end{center}
We conclude that $\# E(\dF_5)=5$, so $\alpha+\beta=1$. In general, 
$\#E(\dF_{5^f}) = (1-\alpha^f)(1-\beta^f)$, so for example 
\begin{align*}
  \# E(\dF_{5^3}) 
    &= (1-\alpha^3)(1-\beta^3) \\
    &= 1-(\alpha^3+\beta^3) + (\alpha\beta)^2 \\
    &= 1-(\alpha+\beta)^3 + 3\alpha\beta(\alpha+\beta) + (2\beta)^3 \\
    &= 1-1^3 + 3\cdot 5\cdot 1 + 5^3 \\
    &= 140 .
\end{align*}
So we see that computing something like $\# E(\dF_q)$ is easy. More 
importantly, $\# E(\dF_q),\# E(\dF_{q^2}),\ldots$ depnds only on two pieces 
of data. This brings us to the Weil Conjectures. 





\subsection{Weil conjectures}

Let $V_{/\dF_q}$ be a smooth proper $d$-dimensional variety. Set 
\[
  Z(V,T) = \exp\left(\sum_{n\geqslant 1} \# V(\dF_{q^n}) \frac{T^n}{n}\right) .
\]
This is just a fancy generating series encoding the numbers $\# V(\dF_{q^n})$. 

\begin{conjecture}[Weil]
\leavevmode
\begin{enumerate}
\item $Z(V,T)\in \dQ(T)$. 
\item $Z\left(V,\displaystyle\frac{1}{q^d T}\right) = \pm q^{d\chi/2} T^\chi Z(V,T)$
\item $Z(V,T)=\prod_{i=0}^{2 d} P_i(T)^{(-1)^{i+1}}$, where $P_i\in \dZ[T]$ and 
the roots of $P_i$ are pure of size $q^{i/2}$. 
\end{enumerate}
\end{conjecture}

Part 1 of the Weil Conjectures tells us that $Z(V,T)$ actually contains only a 
finite amount of information. This was proved by Dwork in [find source]. In 
part 2, $\chi$ is the Euler characteristic of $V$; this was proved by 
Grothendieckin SGA 5. Part 3 was proved by Deligne in [source]. 

The roots of $P_i$ are algebraic numbers. An algebraic number 
$\omega\in \overline\dQ$ is \emph{pure} if the absolute value 
$|\iota(\omega)|$ is the same for all embeddings 
$\iota:\overline\dQ\monic \dC$. Grothendieck proved more than 2; we have 
\[
  Z(V,T) = \prod_{i=0}^{2 d} \det\left(T-\Frob_q,\h_\etale^i(V_{\overline{\dF_q}},\dQ_l)\right)^{(-1)^{i+1}} .
\]
You should think about $\Frob_q$ acting on 
$\tate_l E = \h_\etale^1(E_{\overline{\dF_q}},\dZ_l)$. This is basically 
a rephrasing of the Lefschetz trace formula from algebraic topology. However, 
the algebraic Lefschetz trace formula is enormously difficult. 

Deligne's result settles the Ramanujan conjecture for modular forms. For 
example, define $\tau$ by 
\[
  \Delta=q \prod_{n\geqslant 1} (1-q^n)^{24} = \sum_{n\geqslant 0} \tau(n) q^n .
\]
The Ramanujan conjecture is: $|\tau(p)|\leqslant p^{11/2}$. Even here, 
algebraic geometry is lurking under the surface. 





